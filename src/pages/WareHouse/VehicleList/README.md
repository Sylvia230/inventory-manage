# 在库车辆列表页面 - 查看详情功能

## 功能概述

为在库车辆列表页面添加了查看详情功能，点击"查看"按钮时会调用`getInStockVehicleDetailApi`接口获取车辆的详细信息。

## 新增功能

### 1. 查看详情接口调用

#### API接口
- **接口名称**: `getInStockVehicleDetailApi`
- **请求方式**: POST
- **接口路径**: `/inStockVehicle/detail`
- **请求参数**: `{ id: string }`

#### 详情数据包含
- 车辆基本信息
- GPS绑定信息
- 入库信息
- 验车信息
- 车辆照片（常规照片和质损照片）

### 2. 详情弹窗展示

#### 车辆信息
- 车架号
- 车辆属性
- 车辆库龄
- 关单/合格证状态

#### 基本信息
- 业务类型
- 客户信息
- 联系人信息
- 停放仓库

#### GPS信息
- 绑定状态（在线/离线/未绑定）
- 当前设备号
- 安装位置
- 绑定时间
- 绑定人
- 设备来源

#### 入库信息
- 入库类型
- 系统入库时间
- 实际入库时间
- 入库管理员

#### 验车信息
- 验车时间
- 验车人
- 里程数
- 生产日期
- 合格证/关单状态

#### 车辆照片
- **常规照片**: 11张标准验车照片
  - 左前45度照片
  - 左前门含A柱的照片
  - 左后门的照片
  - 后轮轮毂照片
  - 中控台照片
  - 仪表盘照片
  - 右后45度照片
  - 右前门含A柱的照片
  - 铭牌照片
  - 商品车入库信息采集表
  - 发动机舱
- **质损照片**: 车辆损坏照片（如有）

### 3. 技术实现

#### 接口调用
```typescript
const handleViewDetail = async (record: VehicleRecord) => {
  try {
    setLoading(true);
    
    // 调用获取详情接口
    const res = await getInStockVehicleDetailApi({ id: record.id });
    
    if (res?.result) {
      // 合并详情数据到记录中
      const detailData = {
        ...record,
        ...res.result,
        inspectionPhotos: res.result.inspectionPhotos || [],
        damagePhotos: res.result.damagePhotos || [],
      };
      
      setCurrentRecord(detailData);
      setDetailModalVisible(true);
    } else {
      message.error('获取车辆详情失败');
    }
  } catch (error) {
    console.error('获取车辆详情失败:', error);
    message.error('获取车辆详情失败');
  } finally {
    setLoading(false);
  }
};
```

#### 数据合并
- 将API返回的详情数据与列表中的基础数据合并
- 确保照片数据正确显示
- 处理空数据情况

#### 加载状态
- 调用接口时显示加载状态
- 弹窗显示确认加载状态
- 错误处理和用户提示

### 4. 照片展示功能

#### 照片预览
- 点击照片可放大预览
- 支持照片标题显示
- 响应式图片展示

#### 照片分类
- 使用Tabs组件分类展示
- 常规照片和质损照片分开显示
- 质损照片数量标签显示

#### 照片网格布局
- 响应式网格布局
- 照片标签显示
- 空状态处理

### 5. 用户体验

#### 交互流程
1. 用户点击"查看"按钮
2. 显示加载状态
3. 调用详情接口
4. 打开详情弹窗
5. 展示完整车辆信息

#### 错误处理
- 接口调用失败时显示错误提示
- 数据为空时的友好提示
- 网络异常的处理

#### 加载状态
- 按钮加载状态
- 弹窗确认加载状态
- 防止重复点击

## 使用说明

1. **访问路径**: `/warehouse/inStock`
2. **操作步骤**:
   - 在车辆列表中点击"查看"按钮
   - 等待详情数据加载
   - 查看车辆详细信息
   - 点击照片可放大预览
   - 点击"关闭"按钮关闭弹窗

## 注意事项

- 需要确保车辆记录包含有效的id字段
- 接口调用失败会显示错误提示
- 照片数据为空时会显示占位符
- 加载过程中会显示加载状态
- 详情数据会与列表数据合并显示

## 后续优化建议

- [ ] 添加详情数据缓存机制
- [ ] 支持详情数据的编辑功能
- [ ] 添加照片批量下载功能
- [ ] 优化照片加载性能
- [ ] 添加详情数据的导出功能 