# 增强版车辆照片上传功能使用指南

## 功能概述

运单详情页面提供了完整的车辆照片上传和管理功能，支持11种特定类型的照片上传，具备上传、预览、删除等完整功能。

## 支持的照片类型

1. **左前45度照片** - 车辆左前方45度角照片
2. **左前门含A柱照片** - 左前门和A柱照片
3. **左后门照片** - 左后门照片
4. **后轮轮毂照片** - 后轮轮毂照片
5. **中控台照片** - 车内中控台照片
6. **仪表盘照片** - 仪表盘照片
7. **右后45度照片** - 车辆右后方45度角照片
8. **右前门含A柱照片** - 右前门和A柱照片
9. **铭牌照片** - 车辆铭牌照片
10. **商品车入库信息采集表** - 入库信息表照片
11. **发动机舱** - 发动机舱照片

## 主要功能特性

### 1. 智能上传界面
- **网格布局**：一行显示3个上传框，自适应响应式设计
- **状态切换**：上传成功后自动切换为图片预览模式
- **拖拽上传**：支持点击和拖拽两种上传方式

### 2. 图片预览和管理
- **悬停效果**：鼠标悬停显示操作按钮
- **预览功能**：点击图片或预览按钮查看大图
- **删除功能**：点击删除按钮移除图片，恢复上传框

### 3. 完整的上传流程
- **实时反馈**：上传过程中显示进度提示
- **批量保存**：支持一次性保存多张照片
- **资源管理**：自动清理临时文件，防止内存泄漏

## 使用方法

### 上传照片
1. 点击车辆表格中的"上传照片"按钮
2. 在弹出的模态框中选择要上传的照片类型
3. 点击对应的上传框或拖拽文件到上传区域
4. 上传成功后，上传框会变成图片预览

### 管理照片
1. **预览照片**：点击已上传的图片或预览按钮
2. **删除照片**：悬停在图片上，点击删除按钮
3. **重新上传**：删除照片后，上传框会重新显示

### 保存照片
1. 上传完所有需要的照片后
2. 点击"保存照片"按钮确认保存
3. 系统会将所有照片保存到服务器

## 技术实现

### 核心功能
```typescript
// 上传状态管理
const [uploadedPhotos, setUploadedPhotos] = useState<{[key: string]: any}>({});

// 动态上传配置
const createUploadProps = (photoName: string, photoLabel: string) => ({
  // 配置项...
});

// 智能显示逻辑
{uploadedPhotos[photo.name] ? (
  // 显示已上传图片
) : (
  // 显示上传按钮
)}
```

### 样式特性
- **响应式布局**：桌面端3列，平板端2列，手机端1列
- **悬停效果**：图片缩放和操作按钮显示
- **平滑过渡**：所有交互都有平滑的过渡动画

## 文件限制

- **支持格式**：JPG、PNG
- **文件大小**：最大10MB
- **上传数量**：每种类型最多1张

## 注意事项

1. **资源管理**：关闭模态框时会自动清理临时文件
2. **数据持久化**：只有点击"保存照片"后才会真正保存到服务器
3. **用户体验**：上传成功后立即显示预览，提供即时反馈
4. **错误处理**：完善的错误提示和异常处理机制

## 相关文件

- `src/pages/Waybill/WaybillDetail/index.tsx` - 主要组件
- `src/pages/Waybill/WaybillDetail/index.module.less` - 样式文件
- `src/services/waybill.ts` - API服务

## 更新日志

### v2.0 增强功能
- ✅ 上传成功后隐藏上传框，显示图片预览
- ✅ 支持删除已上传图片，恢复上传框
- ✅ 添加图片预览和管理功能
- ✅ 完善的资源管理和内存清理
- ✅ 优化的用户交互体验 