import{r,F as l,u as N,e as F,j as a,C as R,I as x,S as b,B as o}from"./index-DFmaZUvW.js";import{G as z}from"./taskCenter-D1re2V9O.js";import{S as n}from"./index-Bqyftg-u.js";import{R as _}from"./SearchOutlined-DL9voMCh.js";import{R as P}from"./ReloadOutlined-CzbpDPLD.js";import{F as D}from"./Table-DIemrw74.js";import"./Pagination-B-JRzDfY.js";const O="_priceCheck_1mq25_1",V={priceCheck:O},{Option:c}=n,K=()=>{const[d,i]=r.useState(!1),[u,j]=r.useState([]),[T,v]=r.useState(!1),[$,S]=r.useState(null),[s]=l.useForm(),m=N(),[h]=F(),k=[{label:"待处理",value:"pending"},{label:"处理中",value:"processing"},{label:"已完成",value:"completed"}],g=[{label:"待确认",value:"unconfirmed"},{label:"已确认",value:"confirmed"},{label:"已取消",value:"cancelled"}],f=[{label:"未开始",value:"not_started"},{label:"进行中",value:"in_progress"},{label:"已完成",value:"finished"},{label:"已暂停",value:"paused"}],p=async()=>{try{i(!0);const e=await s.validateFields();let t=await z({page:1,pageSize:20,type:1,...e});console.log("Search values:",e,t),j(t||[])}catch(e){console.error("Search error:",e)}finally{i(!1)}},w=e=>{m(`/orderManage/detail/${e}`)},y=[{title:"订单号",dataIndex:"orderNo",key:"orderNo",width:180,render:e=>a.jsx("a",{onClick:()=>w(e),children:e})},{title:"产品类型",dataIndex:"bizCategorySubDesc",key:"bizCategorySubDesc",width:120},{title:"客户名称",dataIndex:"vendorName",key:"vendorName",width:180},{title:"合同金额",dataIndex:"contractAmountStr",key:"contractAmountStr",width:120},{title:"资方名称",dataIndex:"capitalName",key:"capitalName",width:150},{title:"状态",dataIndex:"status",key:"status",width:100,render:(e,t)=>a.jsx("div",{children:t.taskStatusDesc})},{title:"操作",key:"action",fixed:"right",width:120,render:(e,t)=>a.jsx(b,{size:"middle",children:t.taskStatus===1&&a.jsx(o,{type:"primary",size:"small",onClick:()=>C(t),disabled:t.taskStatus==="completed",children:"核价处理"})})}],C=e=>{S(e),v(!0),s.setFieldsValue({orderId:e.orderId,modelName:e.modelName,guidePrice:e.guidePrice}),m(`/taskCenter/priceCheckDetail/${e.taskId}`)};r.useEffect(()=>{const e=h.get("orderNumber");e&&(s.setFieldsValue({orderNumber:e}),console.log("从订单页面跳转，自动填充订单号:",e)),i(!0),setTimeout(()=>{p(),i(!1)},1e3)},[h]);const I=()=>{s.resetFields()};return a.jsx("div",{className:V.priceCheck,children:a.jsxs(R,{children:[a.jsxs(l,{form:s,layout:"inline",className:"mb-12",children:[a.jsx(l.Item,{name:"orderNumber",label:"订单号",children:a.jsx(x,{placeholder:"请输入订单号",allowClear:!0})}),a.jsx(l.Item,{name:"dealer",label:"经销商",children:a.jsx(x,{placeholder:"请输入经销商",allowClear:!0})}),a.jsx(l.Item,{name:"progressStatus",label:"进度状态",children:a.jsx(n,{mode:"multiple",placeholder:"请选择进度状态",style:{width:200},allowClear:!0,children:k.map(e=>a.jsx(c,{value:e.value,children:e.label},e.value))})}),a.jsx(l.Item,{name:"orderStatus",label:"订单状态",children:a.jsx(n,{mode:"multiple",placeholder:"请选择订单状态",style:{width:200},allowClear:!0,children:g.map(e=>a.jsx(c,{value:e.value,children:e.label},e.value))})}),a.jsx(l.Item,{name:"taskStatus",label:"任务状态",children:a.jsx(n,{mode:"multiple",placeholder:"请选择任务状态",style:{width:200},allowClear:!0,children:f.map(e=>a.jsx(c,{value:e.value,children:e.label},e.value))})}),a.jsx(l.Item,{children:a.jsxs(b,{children:[a.jsx(o,{type:"primary",icon:a.jsx(_,{}),onClick:p,loading:d,children:"查询"}),a.jsx(o,{icon:a.jsx(P,{}),onClick:I,children:"重置"})]})})]}),a.jsx(D,{columns:y,dataSource:u,loading:d,rowKey:"vehicleId",scroll:{x:1500},pagination:{total:u.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`}})]})})};export{K as default};
