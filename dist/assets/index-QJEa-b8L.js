import{r,F as l,u as N,e as F,j as a,C as P,I as x,S as v,B as n}from"./index-Chixbmna.js";import{G as R}from"./taskCenter-CPhI0IMP.js";import{S as d}from"./index-CTVR2mE-.js";import{R as _}from"./SearchOutlined-CJakv6Nz.js";import{R as T}from"./ReloadOutlined-DjkM37kN.js";import{F as z}from"./Table-DsHeEN0d.js";import"./Pagination-Du2F-cir.js";const O="_priceCheck_1mq25_1",V={priceCheck:O},{Option:o}=d,K=()=>{const[c,i]=r.useState(!1),[u,j]=r.useState([]),[D,k]=r.useState(!1),[$,I]=r.useState(null),[s]=l.useForm(),m=N(),[h]=F(),w=[{label:"待处理",value:"pending"},{label:"处理中",value:"processing"},{label:"已完成",value:"completed"}],b=[{label:"待确认",value:"unconfirmed"},{label:"已确认",value:"confirmed"},{label:"已取消",value:"cancelled"}],y=[{label:"未开始",value:"not_started"},{label:"进行中",value:"in_progress"},{label:"已完成",value:"finished"},{label:"已暂停",value:"paused"}],p=async()=>{try{i(!0);const e=await s.validateFields();let t=await R({page:1,pageSize:20,type:1,...e});console.log("Search values:",e,t),j(t||[])}catch(e){console.error("Search error:",e)}finally{i(!1)}},g=e=>{m(`/orderManage/detail/${e}`)},f=[{title:"订单号",dataIndex:"orderNo",key:"orderNo",width:180,render:e=>a.jsx("a",{onClick:()=>g(e),children:e})},{title:"产品名称",dataIndex:"productName",key:"productName",width:150},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180},{title:"厂商指导价",dataIndex:"guidePrice",key:"guidePrice",width:120},{title:"车型",dataIndex:"modelName",key:"modelName",width:250},{title:"外观",dataIndex:"exterior",key:"exterior",width:100},{title:"内饰",dataIndex:"interior",key:"interior",width:100},{title:"车辆ID",dataIndex:"vehicleId",key:"vehicleId",width:100},{title:"车架号",dataIndex:"vin",key:"vin",width:180},{title:"状态",dataIndex:"status",key:"status",width:100,render:(e,t)=>a.jsx("div",{children:t.taskStatusDesc})},{title:"操作",key:"action",fixed:"right",width:120,render:(e,t)=>a.jsx(v,{size:"middle",children:t.status===1&&a.jsx(n,{type:"primary",size:"small",onClick:()=>S(t),disabled:t.status==="completed",children:"核价处理"})})}],S=e=>{I(e),k(!0),s.setFieldsValue({orderId:e.orderId,modelName:e.modelName,guidePrice:e.guidePrice}),m(`/taskCenter/priceCheckDetail/${e.taskId}`)};r.useEffect(()=>{const e=h.get("orderNumber");e&&(s.setFieldsValue({orderNumber:e}),console.log("从订单页面跳转，自动填充订单号:",e)),i(!0),setTimeout(()=>{p(),i(!1)},1e3)},[h]);const C=()=>{s.resetFields()};return a.jsx("div",{className:V.priceCheck,children:a.jsxs(P,{children:[a.jsxs(l,{form:s,layout:"inline",className:"mb-12",children:[a.jsx(l.Item,{name:"orderNumber",label:"订单号",children:a.jsx(x,{placeholder:"请输入订单号",allowClear:!0})}),a.jsx(l.Item,{name:"dealer",label:"经销商",children:a.jsx(x,{placeholder:"请输入经销商",allowClear:!0})}),a.jsx(l.Item,{name:"progressStatus",label:"进度状态",children:a.jsx(d,{mode:"multiple",placeholder:"请选择进度状态",style:{width:200},allowClear:!0,children:w.map(e=>a.jsx(o,{value:e.value,children:e.label},e.value))})}),a.jsx(l.Item,{name:"orderStatus",label:"订单状态",children:a.jsx(d,{mode:"multiple",placeholder:"请选择订单状态",style:{width:200},allowClear:!0,children:b.map(e=>a.jsx(o,{value:e.value,children:e.label},e.value))})}),a.jsx(l.Item,{name:"taskStatus",label:"任务状态",children:a.jsx(d,{mode:"multiple",placeholder:"请选择任务状态",style:{width:200},allowClear:!0,children:y.map(e=>a.jsx(o,{value:e.value,children:e.label},e.value))})}),a.jsx(l.Item,{children:a.jsxs(v,{children:[a.jsx(n,{type:"primary",icon:a.jsx(_,{}),onClick:p,loading:c,children:"查询"}),a.jsx(n,{icon:a.jsx(T,{}),onClick:C,children:"重置"})]})})]}),a.jsx(z,{columns:f,dataSource:u,loading:c,rowKey:"vehicleId",scroll:{x:1500},pagination:{total:u.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`}})]})})};export{K as default};
