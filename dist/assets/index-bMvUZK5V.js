import{r as u,b as w,j as e,S as c,C as b,c as I,T as f}from"./index-D8ReppmJ.js";import{o as k}from"./index-DAWYBd6M.js";import{D as a}from"./index-BTfwLZ3y.js";import{I as h}from"./index-BI5YGdgn.js";import{F as x}from"./Table-uXQ28xlW.js";import{T as g}from"./index-BzBpE7l5.js";import{o as m}from"./index-BiEhHuj5.js";import"./mobx.esm-J_RULll_.js";import"./Pagination-DkTh5KJv.js";import"./index-D5ba-O3m.js";var v={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};function y(){return y=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},y.apply(this,arguments)}const R=(t,i)=>u.createElement(w,y({},t,{ref:i,icon:v})),S=u.forwardRef(R),C=({orderDetail:t})=>{var n;const i=[{label:"保证金",key:"depositVoucher"},{label:"本息",key:"principalInterestVoucher"},{label:"服务费",key:"serviceFeeVoucher"},{label:"仓储费",key:"storageFeeVoucher"},{label:"物流费",key:"logisticsFeeVoucher"}];return e.jsxs(a,{bordered:!0,children:[e.jsx(a.Item,{label:"订单号",span:3,children:t.orderNo}),e.jsx(a.Item,{label:"产品名称",span:3,children:t.productName}),e.jsx(a.Item,{label:"产品类型",span:3,children:t.productType}),e.jsx(a.Item,{label:"申请时间",span:3,children:t.createTime}),e.jsx(a.Item,{label:"申请单状态",span:3,children:t.orderStatusDesc}),e.jsx(a.Item,{label:"经销商",span:3,children:t.dealer}),e.jsx(a.Item,{label:"经销商业务经理",span:3,children:t.dealerManager}),e.jsx(a.Item,{label:"申请人",span:3,children:t.applicant}),e.jsx(a.Item,{label:"经销商联系方式",span:3,children:t.dealerContact}),e.jsx(a.Item,{label:"经销商经营范围",span:3,children:t.dealerBusinessScope}),e.jsx(a.Item,{label:"供应商",span:3,children:t.supplier}),e.jsx(a.Item,{label:"联系人",span:3,children:t.supplierContact}),e.jsx(a.Item,{label:"供应商联系方式",span:3,children:t.supplierContactInfo}),i.map(({label:l,key:o})=>{var d;return e.jsx(a.Item,{label:`${l}凭证`,span:3,children:e.jsx(c,{children:(d=t[o])==null?void 0:d.map((s,r)=>e.jsx(h,{width:100,height:100,src:s,alt:`${l}凭证${r+1}`,style:{objectFit:"cover"}},r))})},o)}),e.jsx(a.Item,{label:"其他照片",span:3,children:e.jsx(c,{children:(n=t.otherPhotos)==null?void 0:n.map((l,o)=>e.jsx(h,{width:100,height:100,src:l,alt:`其他照片${o+1}`,style:{objectFit:"cover"}},o))})})]})},E=({vehicle:t})=>{var i,n,l;return e.jsx("div",{style:{padding:"16px"},children:e.jsxs(c,{direction:"vertical",size:"large",style:{width:"100%"},children:[t.inspectionPhotos&&t.inspectionPhotos.length>0&&e.jsx(a,{title:"验车照片",bordered:!0,children:e.jsx(a.Item,{span:3,children:e.jsx(c,{wrap:!0,children:(i=t.inspectionPhotos)==null?void 0:i.map((o,d)=>e.jsx(h,{width:200,height:150,src:o,alt:`验车照片${d+1}`,style:{objectFit:"cover"}},d))})})}),t.damagePhotos&&t.damagePhotos.length>0&&e.jsx(a,{title:"质损照片",bordered:!0,children:e.jsx(a.Item,{span:3,children:e.jsx(c,{wrap:!0,children:(n=t.damagePhotos)==null?void 0:n.map((o,d)=>e.jsx(h,{width:200,height:150,src:o,alt:`质损照片${d+1}`,style:{objectFit:"cover"}},d))})})}),t.documents&&t.documents.length>0&&e.jsx(a,{title:"资料信息",bordered:!0,children:(l=t.documents)==null?void 0:l.map((o,d)=>e.jsx(a.Item,{label:o.name,span:3,children:e.jsx("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",children:"查看文件"})},d))})]})})},P=({orderDetail:t})=>{var d;const[i,n]=u.useState([]);console.log("...orderDetail",t);const l=[{title:"车辆ID",dataIndex:"id",key:"id",width:80,render:(s,r)=>r.isExpandRow?{children:e.jsxs(c,{children:[e.jsx(S,{rotate:i.includes(r.id)?90:0}),"验车照片/质损照片/资料信息"]}),props:{colSpan:l.length}}:s},{title:"车架号",dataIndex:"vin",key:"vin",width:180,render:(s,r)=>r.isExpandRow?{props:{colSpan:0}}:r.vin},{title:"车型",dataIndex:"vehicleName",key:"vehicleName",width:200,render:(s,r)=>r.isExpandRow?{props:{colSpan:0}}:r.model},{title:"外观/内饰",dataIndex:"outerColorDesc",key:"outerColorDesc",width:150,render:(s,r)=>r.isExpandRow?{props:{colSpan:0}}:e.jsxs(c,{direction:"vertical",size:"small",children:[e.jsxs("span",{children:["外观：",r.outerColorDesc]}),e.jsxs("span",{children:["内饰：",r.innerColorDesc]})]})},{title:"厂商指导价",dataIndex:"guidePrice",key:"guidePrice",width:120,render:(s,r)=>r.isExpandRow?{props:{colSpan:0}}:`${r.guidePrice}`},{title:"核价金额",dataIndex:"appraisedPrice",key:"appraisedPrice",width:120,render:(s,r)=>r.isExpandRow?{props:{colSpan:0}}:`${r.appraisedPrice}`},{title:"保证金",dataIndex:"contractAmount",key:"contractAmount",width:120,render:(s,r)=>r.isExpandRow?{props:{colSpan:0}}:`${r.contractAmount}`},{title:"保证金比例",dataIndex:"depositRate",key:"depositRate",width:120,render:(s,r)=>r.isExpandRow?{props:{colSpan:0}}:`${r.depositRate}%`},{title:"合同单价/定金",key:"contract",width:150,render:(s,r)=>{if(r.isExpandRow)return{props:{colSpan:0}};const p=r;return e.jsxs(c,{direction:"vertical",size:"small",children:[e.jsxs("span",{children:["单价：",p.contractPrice]}),e.jsxs("span",{children:["定金：",p.downPayment]})]})}}],o=s=>{var p;if(!s.isExpandRow)return null;const r=(p=t.orderCarList)==null?void 0:p.find(j=>j.id===s.vehicleId);return r?e.jsx(E,{vehicle:r}):null};return e.jsx(c,{direction:"vertical",size:"large",style:{width:"100%"},children:(d=t==null?void 0:t.orderCarList)==null?void 0:d.map((s,r)=>e.jsx(b,{title:`车辆 ${r+1}`,style:{marginBottom:16},children:e.jsx(x,{columns:l,dataSource:[s,{id:`${s.id}-expand`,isExpandRow:!0,vehicleId:s.id}],rowKey:"id",pagination:!1,scroll:{x:"max-content"},expandable:{expandedRowRender:o,rowExpandable:p=>p.isExpandRow===!0,expandedRowKeys:i,onExpand:(p,j)=>{n(p?[j.id]:[])}}})},s.id))})},T=({orderDetail:t})=>{const i=[{title:"车型",dataIndex:"model",key:"model",width:150},{title:"车架号",dataIndex:"vin",key:"vin",width:180},{title:"仓库",dataIndex:"warehouseName",key:"warehouseName",width:150},{title:"联系人/电话",key:"contact",width:180,render:(n,l)=>e.jsxs(c,{direction:"vertical",size:"small",children:[e.jsxs("span",{children:["联系人：",l.contactPerson]}),e.jsxs("span",{children:["电话：",l.contactPhone]})]})},{title:"仓库地址",dataIndex:"warehouseAddress",key:"warehouseAddress",width:200},{title:"出库时间",dataIndex:"outboundTime",key:"outboundTime",width:180},{title:"入库时间",dataIndex:"inboundTime",key:"inboundTime",width:180}];return e.jsx(x,{columns:i,dataSource:t.storageInfo||[],rowKey:"vin",pagination:!1,scroll:{x:"max-content"}})},A=({orderDetail:t})=>{const i=[{title:"车型",dataIndex:"model",key:"model",width:150},{title:"车架号",dataIndex:"vin",key:"vin",width:180},{title:"物流公司",dataIndex:"logisticsCompany",key:"logisticsCompany",width:150},{title:"运单号",dataIndex:"trackingNumber",key:"trackingNumber",width:180},{title:"发货时间",dataIndex:"deliveryTime",key:"deliveryTime",width:180},{title:"预计送达时间",dataIndex:"estimatedDeliveryTime",key:"estimatedDeliveryTime",width:180},{title:"物流状态",dataIndex:"logisticsStatus",key:"logisticsStatus",width:120,render:n=>e.jsx(g,{color:n==="in_transit"?"blue":n==="delivered"?"green":n==="exception"?"red":"default",children:n==="in_transit"?"运输中":n==="delivered"?"已送达":n==="exception"?"异常":n})}];return e.jsx(x,{columns:i,dataSource:t.logisticsInfo||[],rowKey:"vin",pagination:!1,scroll:{x:"max-content"}})},O=({orderDetail:t})=>{const i=[{title:"结算单号",dataIndex:"settlementNumber",key:"settlementNumber",width:180},{title:"结算金额",dataIndex:"settlementAmount",key:"settlementAmount",width:150,render:n=>`¥${n.toLocaleString()}`},{title:"结算状态",dataIndex:"settlementStatus",key:"settlementStatus",width:120,render:n=>e.jsx(g,{color:n==="pending"?"orange":n==="completed"?"green":n==="failed"?"red":"default",children:n==="pending"?"待结算":n==="completed"?"已结算":n==="failed"?"结算失败":n})},{title:"结算时间",dataIndex:"settlementTime",key:"settlementTime",width:180}];return e.jsx(x,{columns:i,dataSource:t.settlementInfo||[],rowKey:"settlementNumber",pagination:!1,scroll:{x:"max-content"}})},N=({orderDetail:t})=>{const i=[{key:"disbursementAccount",label:"出款账户"},{key:"supplierCollectionAccount",label:"供应商收款账户"},{key:"dealerRepaymentAccount",label:"经销商还款账户"},{key:"capitalCollectionAccount",label:"资方收款账户"},{key:"marginCollectionAccount",label:"保证金收款账户"},{key:"serviceFeeCollectionAccount",label:"服务费收款账户"},{key:"storageFeeCollectionAccount",label:"仓储费收款账户"},{key:"logisticsFeeCollectionAccount",label:"物流费收款账户"}];return e.jsx(c,{direction:"vertical",size:"large",style:{width:"100%"},children:i.map(n=>{const l=t[n.key];return l?e.jsxs(a,{title:n.label,bordered:!0,style:{marginBottom:24},children:[e.jsx(a.Item,{label:"户名",span:3,children:l.accountName}),e.jsx(a.Item,{label:"账号",span:3,children:l.bankAccount}),e.jsx(a.Item,{label:"开户行",span:3,children:l.openingBank})]},n.key):null})})},G=k(()=>{const{id:t}=I();console.log("订单详情页面，获取到的订单号:",t);const[i,n]=u.useState(null);if(u.useEffect(()=>()=>{m.clear()},[]),u.useEffect(()=>{if(t)if(console.log("详情页面检查store中的当前订单:",m.currentOrder),m.currentOrder&&(m.currentOrder.orderNumber===t||m.currentOrder.id===t))console.log("详情页面从store获取到当前订单数据:",m.currentOrder),n(m.currentOrder);else{const o=m.getOrderByNo(t);console.log("...orderData",o),n(o)}},[t]),!i)return e.jsx("div",{children:"加载中..."});const l=[{key:"basic",label:"基本信息",children:e.jsx(C,{orderDetail:i})},{key:"vehicle",label:"车辆信息",children:e.jsx(P,{orderDetail:i})},{key:"storage",label:"仓储信息",children:e.jsx(T,{orderDetail:i})},{key:"logistics",label:"物流信息",children:e.jsx(A,{orderDetail:i})},{key:"settlement",label:"结算信息",children:e.jsx(O,{orderDetail:i})},{key:"account",label:"账户信息",children:e.jsx(N,{orderDetail:i})}];return e.jsx("div",{children:e.jsx(b,{style:{marginTop:"24px"},children:e.jsx(f,{items:l})})})});export{G as default};
