import{r as s,j as t,B as u,S as V}from"./index-BVAS8uCo.js";import{y as f}from"./index-CDp1POuM.js";import{F as r}from"./index-DBkfi3mz.js";import{I as m}from"./index-BpOE9vUG.js";import{R as D}from"./SearchOutlined-cd-ZIqc2.js";import{F as H,S as p}from"./Table-_Q0Ze7Xm.js";import{M as S}from"./index-B-u7i6R4.js";import{T as L}from"./index-KX8pTv_G.js";import{s as h}from"./index-uqdkvZpm.js";import"./EyeOutlined-6VNoh7_U.js";import"./Skeleton-cdMzRux_.js";const O="_container_1mvle_1",$="_header_1mvle_6",b={container:O,header:$};async function A(l){return f.post("/api/staff/add",l)}async function B(l){return f.post("/api/staff/update",l)}async function N(l){return f.post("/api/staff/delete",l)}const J=[{label:"技术部",value:"技术部"},{label:"市场部",value:"市场部"},{label:"人事部",value:"人事部"},{label:"财务部",value:"财务部"}],K=[{label:"开发工程师",value:"开发工程师"},{label:"产品经理",value:"产品经理"},{label:"市场经理",value:"市场经理"},{label:"HR专员",value:"HR专员"},{label:"财务专员",value:"财务专员"}],le=()=>{const[l,o]=s.useState(!1),[P,k]=s.useState(""),[w,i]=s.useState(!1),[x,y]=s.useState("add"),[I,v]=s.useState(null),[n]=r.useForm(),[T,C]=s.useState([]),[c,g]=s.useState({current:1,pageSize:10,total:0}),j=[{id:"1",name:"张三",phone:"13800138000",department:"技术部",role:"开发工程师",status:"active"},{id:"2",name:"李四",phone:"13800138001",department:"市场部",role:"市场经理",status:"active"},{id:"3",name:"王五",phone:"13800138002",department:"人事部",role:"HR专员",status:"inactive"}],d=async(e={})=>{try{o(!0),C(j),g(a=>({...a,total:j.length}))}catch(a){console.error("获取员工列表失败:",a)}finally{o(!1)}};s.useEffect(()=>{d()},[c.current,c.pageSize]);const F=e=>{g(e)},R=e=>{k(e),d({})},M=()=>{y("add"),v(null),i(!0),n.resetFields()},_=e=>{y("edit"),v(e),i(!0),n.setFieldsValue(e)},q=e=>{S.confirm({title:"确认删除",content:`确定要删除员工 ${e.name} 吗？`,okText:"确认",cancelText:"取消",onOk:async()=>{try{o(!0),await N(e.id),h.success("删除成功"),d()}catch(a){console.error("删除失败:",a)}finally{o(!1)}}})},z=async()=>{try{const e=await n.validateFields();x==="add"?(await A(e),h.success("新增成功")):(await B({...I,...e}),h.success("编辑成功")),i(!1),n.resetFields(),d()}catch(e){console.error("表单提交失败:",e)}},E=[{title:"姓名",dataIndex:"name",key:"name",width:120},{title:"手机号",dataIndex:"phone",key:"phone",width:150},{title:"部门",dataIndex:"department",key:"department",width:150},{title:"角色",dataIndex:"role",key:"role",width:150},{title:"状态",dataIndex:"status",key:"status",width:100,render:e=>t.jsx(L,{color:e==="active"?"green":"red",children:e==="active"?"在职":"离职"})},{title:"操作",key:"action",width:200,render:(e,a)=>t.jsxs(V,{size:"middle",children:[t.jsx(u,{type:"link",onClick:()=>_(a),children:"编辑"}),t.jsx(u,{type:"link",danger:!0,onClick:()=>q(a),children:"删除"})]})}];return t.jsxs("div",{className:b.container,children:[t.jsxs("div",{className:b.header,children:[t.jsx(m,{placeholder:"搜索姓名/手机号",prefix:t.jsx(D,{}),onChange:e=>R(e.target.value),style:{width:200}}),t.jsx(u,{type:"primary",onClick:M,children:"新增员工"})]}),t.jsx(H,{columns:E,dataSource:T,loading:l,rowKey:"id",pagination:{...c,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`},onChange:F}),t.jsx(S,{title:x==="add"?"新增员工":"编辑员工",open:w,onOk:z,onCancel:()=>{i(!1),n.resetFields()},destroyOnClose:!0,children:t.jsxs(r,{form:n,layout:"vertical",children:[t.jsx(r.Item,{name:"name",label:"姓名",rules:[{required:!0,message:"请输入姓名"}],children:t.jsx(m,{placeholder:"请输入姓名"})}),t.jsx(r.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],children:t.jsx(m,{placeholder:"请输入手机号",maxLength:11})}),t.jsx(r.Item,{name:"department",label:"部门",rules:[{required:!0,message:"请选择部门"}],children:t.jsx(p,{placeholder:"请选择部门",options:J})}),t.jsx(r.Item,{name:"role",label:"角色",rules:[{required:!0,message:"请选择角色"}],children:t.jsx(p,{placeholder:"请选择角色",options:K})}),t.jsx(r.Item,{name:"status",label:"状态",initialValue:"active",rules:[{required:!0,message:"请选择状态"}],children:t.jsx(p,{options:[{label:"在职",value:"active"},{label:"离职",value:"inactive"}]})})]})})]})};export{le as default};
