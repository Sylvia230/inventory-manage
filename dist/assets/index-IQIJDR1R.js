import{r as s,j as t,B as m,S as E}from"./index-BVAS8uCo.js";import{y as u}from"./index-CDp1POuM.js";import{F as d}from"./index-DBkfi3mz.js";import{F as q,S as O}from"./Table-_Q0Ze7Xm.js";import{M as S}from"./index-B-u7i6R4.js";import{I as V}from"./index-BpOE9vUG.js";import{s as p}from"./index-uqdkvZpm.js";import"./EyeOutlined-6VNoh7_U.js";import"./Skeleton-cdMzRux_.js";const A="_container_iawkd_1",B="_header_iawkd_7",v={container:A,header:B};async function D(n){return u.post("/api/role/add",n)}async function H(n){return u.post("/api/role/update",n)}async function N(n){return u.post("/api/role/delete",n)}const $=[{id:"1",name:"张三",phone:"13800138000",department:"技术部",role:"开发工程师",status:"active"},{id:"2",name:"李四",phone:"13800138001",department:"技术部",role:"产品经理",status:"active"},{id:"3",name:"王五",phone:"13800138002",department:"市场部",role:"市场经理",status:"active"},{id:"4",name:"赵六",phone:"13800138003",department:"人事部",role:"HR专员",status:"active"},{id:"5",name:"钱七",phone:"13800138004",department:"财务部",role:"财务专员",status:"active"},{id:"6",name:"孙八",phone:"13800138005",department:"技术部",role:"测试工程师",status:"active"},{id:"7",name:"周九",phone:"13800138006",department:"市场部",role:"市场专员",status:"active"},{id:"8",name:"吴十",phone:"13800138007",department:"人事部",role:"招聘专员",status:"active"}],k=[{id:"1",name:"系统管理员",description:"系统最高权限管理员，可以管理所有功能",staffIds:["1","2"],staffList:[{id:"1",name:"张三",phone:"13800138000",department:"技术部",role:"开发工程师",status:"active"},{id:"2",name:"李四",phone:"13800138001",department:"技术部",role:"产品经理",status:"active"}],createTime:"2024-01-01 12:00:00",updateTime:"2024-01-01 12:00:00"},{id:"2",name:"部门主管",description:"部门负责人，可以管理本部门员工",staffIds:["3"],staffList:[{id:"3",name:"王五",phone:"13800138002",department:"市场部",role:"市场经理",status:"active"}],createTime:"2024-01-01 12:00:00",updateTime:"2024-01-01 12:00:00"},{id:"3",name:"普通员工",description:"普通员工，只能查看和操作自己的数据",staffIds:["4","5"],staffList:[{id:"4",name:"赵六",phone:"13800138003",department:"人事部",role:"HR专员",status:"active"},{id:"5",name:"钱七",phone:"13800138004",department:"财务部",role:"财务专员",status:"active"}],createTime:"2024-01-01 12:00:00",updateTime:"2024-01-01 12:00:00"}],Z=()=>{const[n,r]=s.useState(!1),[w,o]=s.useState(!1),[h,f]=s.useState("add"),[j,y]=s.useState(null),[i]=d.useForm(),[T,g]=s.useState([]),[I,R]=s.useState([]),[l,x]=s.useState({current:1,pageSize:10,total:0}),L=async()=>{try{R($)}catch(e){console.error("获取员工列表失败:",e)}},c=async(e={})=>{try{r(!0),g(k),x(a=>({...a,total:k.length}))}catch(a){console.error("获取角色列表失败:",a)}finally{r(!1)}};s.useEffect(()=>{c(),L()},[l.current,l.pageSize]);const F=e=>{x(e)},C=[{title:"角色名称",dataIndex:"name",key:"name",width:150},{title:"已选员工",dataIndex:"staffList",key:"staffList",width:200,render:e=>t.jsx("span",{children:e.map(a=>a.name).join(", ")})},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180},{title:"更新时间",dataIndex:"updateTime",key:"updateTime",width:180},{title:"操作",key:"action",width:150,render:(e,a)=>t.jsxs(E,{size:"middle",children:[t.jsx(m,{type:"link",onClick:()=>M(a),children:"编辑"}),t.jsx(m,{type:"link",danger:!0,onClick:()=>_(a),children:"删除"})]})}],b=()=>{f("add"),y(null),o(!0),i.resetFields()},M=e=>{f("edit"),y(e),o(!0),i.setFieldsValue({...e,staffIds:e.staffIds})},_=e=>{S.confirm({title:"确认删除",content:`确定要删除角色 ${e.name} 吗？`,okText:"确认",cancelText:"取消",onOk:async()=>{try{r(!0),await N(e.id),p.success("删除成功"),c()}catch(a){console.error("删除失败:",a)}finally{r(!1)}}})},z=async()=>{try{const e=await i.validateFields();h==="add"?(await D(e),p.success("新增成功")):(await H({...j,...e}),p.success("编辑成功")),o(!1),i.resetFields(),c()}catch(e){console.error("表单提交失败:",e)}};return t.jsxs("div",{className:v.container,children:[t.jsx("div",{className:v.header,children:t.jsx(m,{type:"primary",onClick:b,children:"新增角色"})}),t.jsx(q,{columns:C,dataSource:T,loading:n,rowKey:"id",pagination:{...l,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`},onChange:F}),t.jsx(S,{title:h==="add"?"新增角色":"编辑角色",open:w,onOk:z,onCancel:()=>{o(!1),i.resetFields()},destroyOnClose:!0,width:600,children:t.jsxs(d,{form:i,layout:"vertical",children:[t.jsx(d.Item,{name:"name",label:"角色名称",rules:[{required:!0,message:"请输入角色名称"}],children:t.jsx(V,{placeholder:"请输入角色名称"})}),t.jsx(d.Item,{name:"staffIds",label:"选择员工",rules:[{required:!0,message:"请选择员工"}],children:t.jsx(O,{mode:"multiple",placeholder:"请选择员工",style:{width:"100%"},options:I.map(e=>({label:e.name,value:e.id}))})})]})})]})};export{Z as default};
