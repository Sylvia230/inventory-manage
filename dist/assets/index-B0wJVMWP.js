import{c as _,u as $,e as J,r as d,F as s,j as e,S as v,B as c,C as m,I,s as g}from"./index-CyB-NFsd.js";import{R}from"./ArrowLeftOutlined-CT1Pur_J.js";import{D as n}from"./index-FC4NsB_w.js";import{F as u}from"./Table-BaXE-4d7.js";import{T as V}from"./index-BtCcC5gM.js";import"./styleChecker-BxO4dLT-.js";import"./index-CyGbgfxR.js";const w="_container_18brn_1",B="_header_18brn_6",z="_card_18brn_15",i={container:w,header:B,card:z},O=()=>{const{settlementId:o}=_(),p=$(),[k]=J(),[t,f]=d.useState(null),[r,S]=d.useState(null),[h]=s.useForm(),y=k.get("mode")==="adjust";d.useEffect(()=>{o&&b(o)},[o]);const b=a=>{const l={JS202403150001:{settlementId:"JS202403150001",orderNo:"YH202411060879036513",vehicleCount:15,customerName:"上海汽车贸易有限公司",type:"deposit",amount:15e4,status:"approved",createTime:"2024-03-15 10:00:00"},JS202403150002:{settlementId:"JS202403150002",orderNo:"YH202411060879036514",vehicleCount:8,deadline:"2024-04-15 23:59:59",type:"interest",amount:2e5,status:"pending",createTime:"2024-03-15 11:00:00"},JS202403150003:{settlementId:"JS202403150003",orderNo:"YH202411060879036515",vehicleCount:12,deadline:"2024-05-15 23:59:59",type:"service",amount:65e3,status:"approved",createTime:"2024-03-15 12:00:00"}},j=l[a]||l.JS202403150001;f(j),j.type==="interest"&&S({startTime:"2024-01-01 00:00:00",endTime:"2024-03-15 23:59:59",chargeDays:74,rate:8e-4})},T=[{key:"1",vehicleType:"奔驰C200",depositAmount:1e4},{key:"2",vehicleType:"宝马320i",depositAmount:12e3},{key:"3",vehicleType:"奥迪A4L",depositAmount:11e3}],A=[{key:"1",vin:"LSVAM4187C2184841",vehicleType:"奔驰C200",loanAmount:15e4,interest:8880,settlementAmount:158880},{key:"2",vin:"LSVAM4187C2184842",vehicleType:"宝马320i",loanAmount:18e4,interest:10656,settlementAmount:190656}],D=[{key:"1",dailyRate:1e-4,fee:500,loanDate:"2024-01-01",endDate:"2024-01-15",chargeDays:14,vehicleType:"奔驰C200",vin:"LSVAM4187C2184841"},{key:"2",dailyRate:1e-4,fee:600,loanDate:"2024-01-01",endDate:"2024-01-18",chargeDays:17,vehicleType:"宝马320i",vin:"LSVAM4187C2184842"}],C=[{title:"车型",dataIndex:"vehicleType",key:"vehicleType"},{title:"保证金金额",dataIndex:"depositAmount",key:"depositAmount",render:a=>`¥${a.toLocaleString()}`}],N=[{title:"车架号",dataIndex:"vin",key:"vin"},{title:"车型",dataIndex:"vehicleType",key:"vehicleType"},{title:"出款金额",dataIndex:"loanAmount",key:"loanAmount",render:a=>`¥${a.toLocaleString()}`},{title:"利息",dataIndex:"interest",key:"interest",render:a=>`¥${a.toLocaleString()}`},{title:"结算金额",dataIndex:"settlementAmount",key:"settlementAmount",render:a=>`¥${a.toLocaleString()}`}],L=[{title:"日费率",dataIndex:"dailyRate",key:"dailyRate",render:a=>`${(a*1e4).toFixed(1)}‰`},{title:"费用",dataIndex:"fee",key:"fee",render:a=>`¥${a.toLocaleString()}`},{title:"借款日期",dataIndex:"loanDate",key:"loanDate"},{title:"结束日期",dataIndex:"endDate",key:"endDate"},{title:"计费天数",dataIndex:"chargeDays",key:"chargeDays",render:a=>`${a}天`},{title:"车型",dataIndex:"vehicleType",key:"vehicleType"},{title:"车架号",dataIndex:"vin",key:"vin"}],x=()=>{p("/financeManage/balance")},F=async()=>{try{const a=await h.validateFields(),l={settlementId:t==null?void 0:t.settlementId,adjustAmount:a.adjustAmount,remark:a.remark,originalAmount:t==null?void 0:t.amount};console.log("调价数据:",l),g.success("调价成功"),p("/financeManage/balance")}catch(a){console.error("调价失败:",a),g.error("调价失败，请重试")}},M=a=>({deposit:"保证金",interest:"本息",service:"服务费"})[a]||a;return t?e.jsxs("div",{className:i.container,children:[e.jsx("div",{className:i.header,children:e.jsxs(v,{children:[e.jsx(c,{icon:e.jsx(R,{}),onClick:x,style:{background:"transparent"},children:"返回"}),e.jsxs("h2",{children:[y?"结算单调价":"结算单详情"," - ",t.settlementId]})]})}),e.jsx(m,{title:"基础信息",className:i.card,children:e.jsxs(n,{column:3,bordered:!0,children:[e.jsx(n.Item,{label:"结算单号",span:1,children:t.settlementId}),e.jsx(n.Item,{label:"订单号",span:1,children:t.orderNo}),e.jsxs(n.Item,{label:"车辆总台数",span:1,children:[t.vehicleCount,"台"]}),t.type==="deposit"&&t.customerName&&e.jsx(n.Item,{label:"客户名称",span:1,children:t.customerName}),(t.type==="interest"||t.type==="service")&&t.deadline&&e.jsx(n.Item,{label:"截止时间",span:1,children:t.deadline}),e.jsx(n.Item,{label:"结算类型",span:1,children:M(t.type)}),e.jsxs(n.Item,{label:"结算金额",span:1,children:["¥",t.amount.toLocaleString()]}),e.jsx(n.Item,{label:"创建时间",span:1,children:t.createTime})]})}),e.jsxs(m,{title:"结算明细",className:i.card,children:[t.type==="deposit"&&e.jsx(u,{columns:C,dataSource:T,pagination:!1}),t.type==="interest"&&r&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{column:4,bordered:!0,children:[e.jsx(n.Item,{label:"开始时间",span:1,children:r.startTime}),e.jsx(n.Item,{label:"结束时间",span:1,children:r.endTime}),e.jsxs(n.Item,{label:"计费天数",span:1,children:[r.chargeDays,"天"]}),e.jsxs(n.Item,{label:"费率",span:1,children:[(r.rate*1e4).toFixed(1),"‰/日"]})]}),e.jsx(u,{columns:N,dataSource:A,pagination:!1,style:{marginTop:"20px"}})]}),t.type==="service"&&e.jsx(u,{columns:L,dataSource:D,pagination:!1})]}),y&&e.jsx(m,{title:"结算单调价",className:i.card,children:e.jsxs(s,{form:h,layout:"vertical",initialValues:{originalAmount:t.amount},children:[e.jsxs("div",{style:{display:"flex",gap:"24px",alignItems:"flex-start"},children:[e.jsx(s.Item,{label:"原结算金额",style:{flex:1},children:e.jsx(I,{value:`¥${t.amount.toLocaleString()}`,disabled:!0,style:{backgroundColor:"#f5f5f5"}})}),e.jsx(s.Item,{name:"adjustAmount",label:"调价金额",rules:[{required:!0,message:"请输入调价金额"},{type:"number",min:.01,message:"调价金额必须大于0"}],style:{flex:1},children:e.jsx(V,{style:{width:"100%"},placeholder:"请输入调价金额",precision:2,min:.01,addonBefore:"¥"})})]}),e.jsx(s.Item,{name:"remark",label:"备注",rules:[{required:!0,message:"请输入调价原因"}],children:e.jsx(I.TextArea,{rows:4,placeholder:"请输入调价原因...",maxLength:500,showCount:!0})}),e.jsx(s.Item,{children:e.jsxs(v,{size:"large",children:[e.jsx(c,{type:"primary",size:"large",onClick:F,children:"确认调价"}),e.jsx(c,{size:"large",onClick:x,children:"取消"})]})})]})})]}):e.jsx("div",{children:"加载中..."})};export{O as default};
