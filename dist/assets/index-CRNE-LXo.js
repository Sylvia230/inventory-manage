import{r as o,j as t,S as R,I as N,B as L}from"./index-D2rM6ovj.js";import{D as _,d as l}from"./index-C__vpxeC.js";import{R as z}from"./SearchOutlined-B9eb8B1y.js";import{S as P}from"./index-Bqt44OL4.js";import{F as B}from"./Table-B7m-L3lW.js";import"./styleChecker-CcZ-Kr6E.js";const E="_container_ppx8d_1",J="_header_ppx8d_7",y={container:E,header:J},{RangePicker:F}=_,A=[{label:"新增员工",value:"新增员工"},{label:"编辑员工",value:"编辑员工"},{label:"删除员工",value:"删除员工"},{label:"新增角色",value:"新增角色"},{label:"编辑角色",value:"编辑角色"},{label:"删除角色",value:"删除角色"}],K=[{id:"1",operationTime:"2024-01-01 10:00:00",name:"张三",operationType:"新增员工",params:'{"name":"李四","phone":"13800138001","department":"技术部"}',phone:"13800138000"},{id:"2",operationTime:"2024-01-01 11:00:00",name:"李四",operationType:"编辑角色",params:'{"roleId":"1","name":"管理员","staffIds":["1","2"]}',phone:"13800138001"},{id:"3",operationTime:"2024-01-01 12:00:00",name:"王五",operationType:"删除员工",params:'{"staffId":"3"}',phone:"13800138002"},{id:"4",operationTime:"2024-01-01 13:00:00",name:"赵六",operationType:"新增角色",params:'{"name":"普通用户","staffIds":["4","5"]}',phone:"13800138003"},{id:"5",operationTime:"2024-01-01 14:00:00",name:"钱七",operationType:"编辑员工",params:'{"staffId":"5","department":"财务部","role":"财务专员"}',phone:"13800138004"}],U=()=>{const[T,d]=o.useState(!1),[g,x]=o.useState([]),[r,c]=o.useState(null),[s,m]=o.useState(""),[i,h]=o.useState(null),[p,u]=o.useState({current:1,pageSize:10,total:0}),w=async(e={})=>{try{d(!0);let a=[...K];if(r){const[n,O]=r;a=a.filter(D=>{const f=l(D.operationTime);return f.isAfter(n)&&f.isBefore(O)})}s&&(a=a.filter(n=>n.name.toLowerCase().includes(s.toLowerCase()))),i&&(a=a.filter(n=>n.operationType===i)),x(a),u(n=>({...n,total:a.length}))}catch(a){console.error("获取操作记录失败:",a)}finally{d(!1)}};o.useEffect(()=>{w()},[r,s,i,p.current,p.pageSize]);const S=e=>{u(e)},j=e=>{c(e)},C=e=>{m(e.target.value)},I=e=>{h(e)},v=()=>{c(null),m(""),h(null)},k=[{title:"操作时间",dataIndex:"operationTime",key:"operationTime",width:180,sorter:(e,a)=>l(e.operationTime).unix()-l(a.operationTime).unix()},{title:"操作人",dataIndex:"name",key:"name",width:120},{title:"操作类型",dataIndex:"operationType",key:"operationType",width:120},{title:"操作参数",dataIndex:"params",key:"params",width:300,render:e=>{try{const a=JSON.parse(e);return t.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap"},children:JSON.stringify(a,null,2)})}catch{return e}}},{title:"手机号码",dataIndex:"phone",key:"phone",width:150}],b=e=>e&&e>l().endOf("day");return t.jsxs("div",{className:y.container,children:[t.jsx("div",{className:y.header,children:t.jsxs(R,{size:"middle",children:[t.jsx(F,{showTime:!0,value:r,onChange:j,disabledDate:b,placeholder:["开始时间","结束时间"]}),t.jsx(N,{placeholder:"搜索操作人",prefix:t.jsx(z,{}),value:s,onChange:C,style:{width:200}}),t.jsx(P,{placeholder:"选择操作类型",value:i,onChange:I,options:A,style:{width:200},allowClear:!0}),t.jsx(L,{onClick:v,children:"重置"})]})}),t.jsx(B,{columns:k,dataSource:g,loading:T,rowKey:"id",pagination:{...p,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`},onChange:S})]})};export{U as default};
