import{F as L,r as u,j as t,B as j,M as S,s}from"./index-D8ReppmJ.js";import{u as T}from"./waybill-Czc8WILP.js";import{R as D}from"./EyeOutlined-qVL_seCx.js";import{R as M}from"./DeleteOutlined-CYZtbHG7.js";import{U as O}from"./index-DwPqOCJo.js";import{R as V}from"./PlusOutlined-8DBRHyq7.js";import{I as $}from"./index-BI5YGdgn.js";const E="_vehiclePhotoUpload_f2egk_1",G="_photoGrid_f2egk_10",N="_photoItem_f2egk_16",z="_uploadedPhoto_f2egk_32",W="_photoActions_f2egk_44",H="_upload_f2egk_32",J="_uploadButton_f2egk_83",i={vehiclePhotoUpload:E,photoGrid:G,photoItem:N,uploadedPhoto:z,photoActions:W,upload:H,uploadButton:J},K=[{name:"leftFront45",label:"左前45度照片",value:"1",required:!0},{name:"leftFrontDoor",label:"左前门含A柱的照片",value:"2",required:!0},{name:"leftRearDoor",label:"左后门的照片",value:"3",required:!0},{name:"rearWheel",label:"后轮轮毂照片",value:"4",required:!0},{name:"centerConsole",label:"中控台照片",value:"5",required:!0},{name:"dashboard",label:"仪表盘照片",value:"6",required:!0},{name:"rightRear45",label:"右后45度照片",value:"7",required:!0},{name:"rightFrontDoor",label:"右前门含A柱的照片",value:"8",required:!0},{name:"nameplate",label:"铭牌照片",value:"9",required:!0},{name:"inventoryForm",label:"商品车入库信息采集表",value:"10",required:!0},{name:"engineBay",label:"发动机舱",value:"11",required:!0}],le=({photoList:_=K,value:d={},onChange:n,maxSize:p=10,accept:w="image/*",disabled:f=!1,showForm:Q=!1,onFormChange:X})=>{const[Y]=L.useForm(),[P,h]=u.useState(!1),[U,g]=u.useState(""),[v,y]=u.useState(""),[c,m]=u.useState({});u.useEffect(()=>{Object.keys(d).length===0&&m({})},[d]);const R=(e,o)=>e.type.startsWith("image/")?e.size/1024/1024<p?!0:(s.error(`图片大小不能超过 ${p}MB！`),!1):(s.error("只能上传图片文件！"),!1),F=async(e,o,r,l)=>{try{s.loading(`正在上传${r}...`,0);const a=await T({file:e});console.log("上传结果:",a);const q=URL.createObjectURL(e),b={uid:Date.now().toString(),name:e.name,status:"done",url:q,originFileObj:e,anglePosition:l,fileUrl:a.result.path};m(B=>({...B,[o]:b}));const A={...d,[o]:[b]};n==null||n(A),s.destroy(),s.success(`${r} 上传成功`)}catch(a){s.destroy(),s.error("照片上传失败"),console.error("照片上传失败:",a)}},I=e=>{var r;(r=c[e])!=null&&r.url&&URL.revokeObjectURL(c[e].url),m(l=>{const a={...l};return delete a[e],a});const o={...d,[e]:[]};n==null||n(o),s.success("照片删除成功")},x=(e,o="照片预览")=>{g(e),y(o),h(!0)},k=(e,o,r)=>({name:"file",multiple:!1,accept:w,showUploadList:!1,beforeUpload:l=>(R(l)&&F(l,e,o,r),!1)});return t.jsxs("div",{className:i.vehiclePhotoUpload,children:[t.jsx("div",{className:i.photoGrid,children:_.map(e=>t.jsx("div",{className:i.photoItem,children:c[e.name]?t.jsxs("div",{className:i.uploadedPhoto,children:[t.jsx("img",{src:c[e.name].url,alt:e.label,style:{width:"200px",height:"140px",objectFit:"cover",borderRadius:"6px"},onClick:()=>x(c[e.name].url||"",e.label)}),t.jsxs("div",{className:i.photoActions,children:[t.jsx(j,{type:"text",icon:t.jsx(D,{}),onClick:()=>x(c[e.name].url||"",e.label),style:{color:"white"}}),t.jsx(j,{type:"text",icon:t.jsx(M,{}),onClick:()=>I(e.name),style:{color:"white"},disabled:f})]})]}):t.jsx(O,{...k(e.name,e.label,e.value),listType:"picture-card",maxCount:1,disabled:f,className:i.upload,children:t.jsxs("div",{className:i.uploadButton,children:[t.jsx(V,{}),t.jsxs("div",{style:{marginTop:8},children:["点击上传",e.label]})]})})},e.name))}),t.jsx(S,{open:P,title:v,footer:null,onCancel:()=>h(!1),width:800,children:t.jsx($,{alt:v,style:{width:"100%"},src:U})})]})};export{le as V};
