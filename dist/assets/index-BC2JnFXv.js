import{r as n,b as X,F as a,e as Y,j as e,M as b,a as x,B as r,I as j,C as Z,R as ee,S as T,d as te,s as d}from"./index-DRPHcA5R.js";import{s as ae}from"./index.module-CBa0FrbO.js";import{d as se}from"./debounce-DZRC7Jxt.js";import{U as le}from"./index-C4aFj8f-.js";import{F as ne}from"./Table-CLghJ34T.js";import{S as L}from"./index-BTE1MxX-.js";import{C as re}from"./index-DMOue6o7.js";import{T as M}from"./index-D5bt7Jyd.js";import"./styleChecker-VBj3MALj.js";var ie={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function v(){return v=Object.assign?Object.assign.bind():function(i){for(var l=1;l<arguments.length;l++){var o=arguments[l];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(i[c]=o[c])}return i},v.apply(this,arguments)}const oe=(i,l)=>n.createElement(X,v({},i,{ref:l,icon:ie})),ce=n.forwardRef(oe),de=({open:i,onCancel:l,onOk:o,loading:c=!1,merchantData:y})=>{const[m]=a.useForm(),[f,h]=Y.useState([]),I=async()=>{try{const u=await m.validateFields();o(u)}catch(u){console.error("Validate Failed:",u)}},p=()=>{m.resetFields(),h([]),l()},C={onRemove:u=>{const k=f.indexOf(u),g=f.slice();g.splice(k,1),h(g)},beforeUpload:u=>(h([u]),!1),fileList:f};return e.jsx(b,{title:"商家审核",open:i,onCancel:p,width:600,footer:[e.jsx(r,{onClick:p,children:"驳回"},"reject"),e.jsx(r,{type:"primary",loading:c,onClick:I,children:"通过"},"approve")],children:e.jsxs(a,{form:m,layout:"inline",initialValues:y,children:[e.jsx(x,{span:24,children:e.jsx(a.Item,{label:"公司全称",name:"name",children:"张三"})}),e.jsx(x,{children:e.jsx(a.Item,{label:"公司地址",name:"address",children:"浙江杭州"})}),e.jsx(x,{span:24,children:e.jsx(a.Item,{label:"营业执照",name:"businessLicense",children:e.jsx(le,{...C,listType:"picture",maxCount:1,accept:"image/*",children:e.jsx(r,{icon:e.jsx(ce,{}),children:"上传营业执照"})})})}),e.jsx(x,{span:24,children:e.jsx(a.Item,{label:"法人信息",name:"legalPerson",children:"李四"})}),e.jsx(x,{span:24,children:e.jsx(a.Item,{label:"经营范围",name:"businessScope",children:"浙江杭州台州"})}),e.jsx(a.Item,{label:"备注",name:"remark",rules:[{required:!0,message:"请输入备注"}],children:e.jsx(j.TextArea,{rows:4,placeholder:"请输入备注",style:{width:"500px"}})})]})})},Ce=()=>{const[i,l]=n.useState(!1),[o]=a.useForm(),[c]=a.useForm(),[y,m]=n.useState(!1),[f,h]=n.useState(!1),[I,p]=n.useState(null),[C,u]=n.useState([]),[k,g]=n.useState(!1),[A,O]=n.useState([]),[P,S]=n.useState(!1),[ue,w]=n.useState(!1),[F,V]=n.useState([{id:"1",name:"测试企业1",creditCode:"91110105MA12345678",legalPerson:"张三",legalPersonId:"110101199001011234",legalSignature:"张三",companySignature:"李四",contactPerson:"王五",businessAddress:"北京市朝阳区xxx街道",creditLevel:"A",creditLimit:1e6,status:"正常"}]),B=[{value:"beijing",label:"北京",children:[{value:"chaoyang",label:"朝阳区",children:[{value:"branch1",label:"朝阳支行"}]}]}],R=t=>{b.confirm({title:"确认加入黑名单",content:`确定要将商家"${t.name}"加入黑名单吗？`,okText:"确认",cancelText:"取消",onOk:async()=>{try{l(!0),V(F.map(s=>s.id===t.id?{...s,status:"黑名单"}:s)),d.success("已加入黑名单")}catch{d.error("操作失败")}finally{l(!1)}}})},q=t=>{p(t),m(!0)},N=t=>{p(t),h(!0)},U=async t=>{try{l(!0),d.success("标签添加成功"),m(!1)}catch{d.error("操作失败")}finally{l(!1)}},$=async t=>{try{l(!0),d.success("银行卡添加成功"),h(!1),c.resetFields()}catch{d.error("操作失败")}finally{l(!1)}},z=async t=>{try{l(!0),console.log("搜索条件：",t)}catch{d.error("搜索失败")}finally{l(!1)}},D=()=>{o.resetFields()},E=t=>{switch(t){case"待审核":return"warning";case"正常":return"success";case"黑名单":return"error";default:return"default"}},H=t=>{switch(t){case"A":return"success";case"B":return"processing";case"C":return"warning";case"D":return"error";default:return"default"}},_=t=>{p(t),S(!0)},J=async t=>{try{w(!0),d.success("审核成功"),S(!1)}catch{d.error("审核失败")}finally{w(!1)}},K=[{title:"商家名称",dataIndex:"name",key:"name"},{title:"统一社会信用代码",width:160,dataIndex:"creditCode",key:"creditCode"},{title:"法人代表",dataIndex:"legalPerson",key:"legalPerson"},{title:"法人代表身份证",width:160,dataIndex:"legalPersonId",key:"legalPersonId"},{title:"法人签章人",dataIndex:"legalSignature",key:"legalSignature"},{title:"企业签章人",dataIndex:"companySignature",key:"companySignature"},{title:"联系人",dataIndex:"contactPerson",key:"contactPerson"},{title:"经营场所",dataIndex:"businessAddress",key:"businessAddress"},{title:"商家信用等级",dataIndex:"creditLevel",key:"creditLevel",render:t=>e.jsx(M,{color:H(t),children:t})},{title:"授信额度",dataIndex:"creditLimit",key:"creditLimit",render:t=>`¥${t.toLocaleString()}`},{title:"状态",dataIndex:"status",key:"status",render:t=>e.jsx(M,{color:E(t),children:t})},{title:"操作",key:"action",fixed:"right",width:"200",render:(t,s)=>e.jsxs("div",{children:[e.jsx(r,{type:"link",onClick:()=>_(s),children:"审核"}),e.jsx(r,{type:"link",onClick:()=>q(s),children:"新增标签"}),s.status!=="黑名单"&&e.jsx(r,{type:"link",onClick:()=>R(s),children:"添加黑名单"}),e.jsx(r,{type:"link",onClick:()=>N(s),children:"添加银行卡"})]})}],Q=async t=>{g(!0);try{const s=[{value:"urgent",label:"加急",color:"red"},{value:"vip",label:"VIP客户",color:"gold"},{value:"new",label:"新客户",color:"green"},{value:"special",label:"特殊处理",color:"purple"}].filter(W=>W.label.toLowerCase().includes(t.toLowerCase()));O(s)}catch{d.error("获取标签列表失败")}finally{g(!1)}},G=n.useMemo(()=>se(Q,500),[]);return e.jsxs("div",{children:[e.jsx(Z,{className:"mb-16",children:e.jsx(a,{form:o,onFinish:z,layout:"inline",children:e.jsxs(ee,{gutter:24,style:{width:"100%"},children:[e.jsx(x,{span:7,children:e.jsx(a.Item,{name:"name",label:"商家名称",children:e.jsx(j,{placeholder:"请输入商家名称",allowClear:!0})})}),e.jsx(x,{span:10,style:{textAlign:"left"},children:e.jsxs(T,{children:[e.jsx(r,{type:"primary",htmlType:"submit",loading:i,children:"查询"}),e.jsx(r,{onClick:D,children:"重置"})]})})]})})}),e.jsx("div",{className:ae.container,children:e.jsx(ne,{columns:K,dataSource:F,rowKey:"id",loading:i,scroll:{x:1500},pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 条`}})}),e.jsx(b,{title:"添加标签",open:y,onOk:U,onCancel:()=>{m(!1),o.resetFields()},okText:"确定",cancelText:"取消",children:e.jsx(a,{form:o,layout:"inline",children:e.jsx(a.Item,{label:"标签",required:!0,tooltip:"请至少选择一个标签",children:e.jsx(L,{style:{width:"280px"},placeholder:"请选择或搜索标签",value:C,onChange:u,onSearch:G,notFoundContent:k?e.jsx(te,{size:"small"}):null,options:A,optionLabelProp:"label",optionFilterProp:"label",showSearch:!0,allowClear:!0})})})}),e.jsx(b,{title:"添加银行卡",open:f,onCancel:()=>{h(!1),c.resetFields()},footer:null,children:e.jsxs(a,{form:c,onFinish:$,layout:"vertical",children:[e.jsx(a.Item,{name:"accountName",label:"户名",rules:[{required:!0,message:"请输入户名"}],children:e.jsx(j,{placeholder:"请输入户名"})}),e.jsx(a.Item,{name:"bankBranch",label:"开户支行",children:e.jsx(re,{options:B,placeholder:"请选择开户支行",allowClear:!0})}),e.jsx(a.Item,{name:"accountNumber",label:"账户",rules:[{required:!0,message:"请输入账户"}],children:e.jsx(j,{placeholder:"请输入账户"})}),e.jsx(a.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],children:e.jsx(j,{placeholder:"请输入手机号"})}),e.jsx(a.Item,{name:"idType",label:"证件类型",children:e.jsx(L,{placeholder:"请选择证件类型",allowClear:!0,options:[{value:"身份证",label:"身份证"},{value:"护照",label:"护照"},{value:"其他",label:"其他"}]})}),e.jsx(a.Item,{name:"idNumber",label:"证件编号",children:e.jsx(j,{placeholder:"请输入证件编号"})}),e.jsx(a.Item,{children:e.jsxs(T,{style:{width:"100%",justifyContent:"flex-end"},children:[e.jsx(r,{onClick:()=>{h(!1),c.resetFields()},children:"取消"}),e.jsx(r,{type:"primary",htmlType:"submit",loading:i,children:"确定"})]})})]})}),e.jsx(de,{open:P,onCancel:()=>S(!1),onOk:J})]})};export{Ce as default};
