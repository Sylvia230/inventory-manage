import{F as l,r,s as x,j as e,R as v,a as i,I as c,S as D,B as u,M as R}from"./index-D-wqIkuG.js";import{g as X}from"./finance-B905i3DV.js";import{S as A}from"./index-DbWrGEU6.js";import{D as Y}from"./index-B21Kr0WP.js";import{R as U}from"./SearchOutlined-C1ZYjfiz.js";import{R as Z}from"./ReloadOutlined-XiCbexZJ.js";import{R as ee}from"./PlusOutlined-DwBRAV9i.js";import{F as ae}from"./Table-CAvvVgJI.js";import{C as le}from"./index-ByYJXtrk.js";import"./dayjs.min-DgkXXTSy.js";import"./Pagination-DhMnuXBS.js";const te="_container_e2zo2_1",re={container:te},{RangePicker:ne}=Y,je=()=>{const[S]=l.useForm(),[o]=l.useForm(),[y,_]=r.useState(!1),[$,m]=r.useState(!1),[g,h]=r.useState(!1),[se,p]=r.useState(null),[F,C]=r.useState(!1),[j,I]=r.useState(null),[N,k]=r.useState(1),[f,M]=r.useState(10),[O,w]=r.useState(0),H=[{label:"身份证",value:"ID_CARD"},{label:"护照",value:"PASSPORT"},{label:"军官证",value:"MILITARY_ID"},{label:"港澳通行证",value:"HONG_KONG_MACAO"},{label:"台湾通行证",value:"TAIWAN"}],B=[{value:"ICBC",label:"中国工商银行",children:[{value:"ICBC_SH_001",label:"上海分行"},{value:"ICBC_SH_002",label:"浦东支行"},{value:"ICBC_SH_003",label:"徐汇支行"}]},{value:"ABC",label:"中国农业银行",children:[{value:"ABC_SH_001",label:"上海分行"},{value:"ABC_SH_002",label:"浦东支行"},{value:"ABC_SH_003",label:"徐汇支行"}]},{value:"BOC",label:"中国银行",children:[{value:"BOC_SH_001",label:"上海分行"},{value:"BOC_SH_002",label:"浦东支行"},{value:"BOC_SH_003",label:"徐汇支行"}]}],P=[{title:"银行账户户名",dataIndex:"accountName",width:150},{title:"卡号",dataIndex:"cardNumber",width:180,render:a=>{const n=a.slice(-4);return`${"*".repeat(a.length-4)}${n}`}},{title:"开户行",dataIndex:"bankName",width:150},{title:"商户id",dataIndex:"merchantId",width:150},{title:"绑定手机号",dataIndex:"phone",width:150,render:a=>a.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2")},{title:"证件号",dataIndex:"idNumber",width:180,render:a=>a.replace(/(\d{4})\d{10}(\d{4})/,"$1**********$2")},{title:"归属方",dataIndex:"owner",width:120},{title:"创建时间",dataIndex:"createTime",width:180},{title:"操作",key:"action",fixed:"right",width:180,render:(a,n)=>e.jsxs(D,{size:"middle",children:[e.jsx(u,{type:"link",onClick:()=>L(n),children:"编辑"}),e.jsx(u,{type:"link",danger:!0,onClick:()=>K(n),children:"删除"})]})}],[z,T]=r.useState([]);r.useEffect(()=>{d()},[N,f]);const d=async a=>{_(!0);try{const n={page:N,pageSize:f,...a},s=await X(n);if(console.log("银行卡列表",s),s!=null&&s.result){const b=(s.result||[]).map(t=>({key:t.id,accountName:t.accountName,cardNumber:t.cardNumber,bankName:t.bankName,merchantId:t.merchantId,phone:t.phone,idNumber:t.idNumber,owner:t.owner,createTime:t.createTime,idType:t.idType,bankBranch:t.bankBranch}));T(b),w(s.totalCount||0)}else{const b=[{key:"1",accountName:"张三",cardNumber:"6222021234567890123",bankName:"中国工商银行",merchantId:"M20240301001",phone:"13800138000",idNumber:"310101199001011234",owner:"个人",createTime:"2024-03-01 10:00:00",idType:"ID_CARD",bankBranch:["ICBC","ICBC_SH_001"]},{key:"2",accountName:"李四",cardNumber:"6228481234567890123",bankName:"中国农业银行",merchantId:"M20240301002",phone:"13900139000",idNumber:"310101199002022345",owner:"企业",createTime:"2024-03-01 11:00:00",idType:"ID_CARD",bankBranch:["ABC","ABC_SH_001"]},{key:"3",accountName:"王五",cardNumber:"6225881234567890123",bankName:"中国银行",merchantId:"M20240301003",phone:"13700137000",idNumber:"310101199003033456",owner:"个人",createTime:"2024-03-01 12:00:00",idType:"ID_CARD",bankBranch:["BOC","BOC_SH_001"]}];T(b),w(b.length)}}catch(n){console.error("获取银行卡列表失败:",n),x.error("获取数据失败")}finally{_(!1)}},E=a=>{console.log("搜索条件:",a),k(1),d(a)},q=()=>{S.resetFields(),k(1),d()},V=()=>{h(!1),p(null),m(!0),o.resetFields()},L=a=>{h(!0),p(a),m(!0),o.setFieldsValue({accountName:a.accountName,bankBranch:a.bankBranch,cardNumber:a.cardNumber,phone:a.phone,idType:a.idType,idNumber:a.idNumber})},G=()=>{m(!1),h(!1),p(null),o.resetFields()},J=async()=>{try{const a=await o.validateFields();console.log("保存银行卡:",a),x.success(g?"编辑成功":"新增成功"),m(!1),h(!1),p(null),o.resetFields(),d()}catch(a){console.error("表单验证失败:",a)}},K=a=>{I(a),C(!0)},Q=async()=>{try{console.log("删除银行卡:",j),x.success("删除成功"),C(!1),I(null),d()}catch(a){console.error("删除失败:",a),x.error("删除失败")}},W=()=>{C(!1),I(null)};return e.jsxs("div",{className:re.container,children:[e.jsxs(l,{form:S,onFinish:E,layout:"inline",children:[e.jsxs(v,{gutter:24,style:{width:"100%"},children:[e.jsx(i,{span:8,children:e.jsx(l.Item,{name:"cardNumber",label:"银行卡账号",children:e.jsx(c,{placeholder:"请输入银行卡账号",allowClear:!0})})}),e.jsx(i,{span:8,children:e.jsx(l.Item,{name:"accountName",label:"户名",children:e.jsx(c,{placeholder:"请输入户名",allowClear:!0})})}),e.jsx(i,{span:8,children:e.jsx(l.Item,{name:"bankName",label:"银行",children:e.jsx(A,{placeholder:"请选择银行",options:B,allowClear:!0})})})]}),e.jsx(i,{span:8,children:e.jsx(l.Item,{name:"createTime",label:"创建时间",children:e.jsx(ne,{style:{width:"100%"}})})}),e.jsx(v,{gutter:24,style:{width:"100%"},children:e.jsx(i,{span:6,children:e.jsxs(D,{children:[e.jsx(u,{icon:e.jsx(U,{}),type:"primary",htmlType:"submit",loading:y,children:"查询"}),e.jsx(u,{icon:e.jsx(Z,{}),onClick:q,children:"重置"}),e.jsx(u,{type:"primary",icon:e.jsx(ee,{}),onClick:V,children:"新增银行卡"})]})})})]}),e.jsx(ae,{columns:P,dataSource:z,loading:y,pagination:{current:N,pageSize:f,total:O,showSizeChanger:!0,showQuickJumper:!0,showTotal:a=>`共 ${a} 条`},onChange:a=>{k(a.current||1),M(a.pageSize||10)},scroll:{x:1300}}),e.jsx(R,{title:g?"编辑银行卡":"新增银行卡",open:$,onOk:J,onCancel:G,width:600,children:e.jsxs(l,{form:o,layout:"vertical",requiredMark:!1,children:[e.jsx(l.Item,{name:"accountName",label:"户名",rules:[{required:!0,message:"请输入户名"}],children:e.jsx(c,{placeholder:"请输入户名"})}),e.jsx(l.Item,{name:"bankBranch",label:"开户支行",rules:[{required:!0,message:"请选择开户支行"}],children:e.jsx(le,{options:B,placeholder:"请选择开户支行",expandTrigger:"hover"})}),e.jsx(l.Item,{name:"cardNumber",label:"账户",rules:[{required:!0,message:"请输入账户"},{pattern:/^\d{16,19}$/,message:"请输入16-19位数字"}],children:e.jsx(c,{placeholder:"请输入账户"})}),e.jsx(l.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],children:e.jsx(c,{placeholder:"请输入手机号"})}),e.jsx(l.Item,{name:"idType",label:"证件类型",children:e.jsx(A,{placeholder:"请选择证件类型",options:H,allowClear:!0})}),e.jsx(l.Item,{name:"idNumber",label:"证件编号",rules:[{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"请输入正确的证件编号"}],children:e.jsx(c,{placeholder:"请输入证件编号"})})]})}),e.jsxs(R,{title:"删除确认",open:F,onOk:Q,onCancel:W,okText:"确认",cancelText:"取消",okButtonProps:{danger:!0},children:[e.jsx("p",{children:"确定要删除该银行卡吗？"}),j&&e.jsxs("p",{style:{color:"#666",fontSize:"14px"},children:["卡号：",j.cardNumber.replace(/(\d{4})\d+(\d{4})/,"$1****$2")]})]})]})};export{je as default};
