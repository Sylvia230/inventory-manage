import{r as o,F as r,u as Y,f as q,j as t,C as J,I as s,S as f,B as m,M as w,a as u,s as k}from"./index-jJHowT7b.js";import{S as p}from"./index-CAebDaVx.js";import{R as _}from"./SearchOutlined-C0W0peK-.js";import{R as X}from"./ReloadOutlined-BHysQfLN.js";import{F as K}from"./Table-Dbz0OIGN.js";import{T as h}from"./index-DwFxCNZb.js";import{T as Q}from"./index-YgLzVSUz.js";import"./Pagination-BWny1OkO.js";const{Option:g}=p,se=()=>{const[b,n]=o.useState(!1),[C,x]=o.useState([]),[P,j]=o.useState(!1),[S,y]=o.useState(!1),[i,F]=o.useState(null),[I]=r.useForm(),[d]=r.useForm(),[c]=r.useForm(),v=Y(),N=[{orderId:"YH202505230922293374",productName:"订单宝-银行精选",createTime:1747991317e3,guidePrice:45e4,modelName:"奥迪A7L 2024款 45 TFSI quattro 黑武士版",exterior:"黑色",interior:"黑色",vehicleId:"V001",vin:"J4MB7E3FXY0B1C48X",status:"processing",preCreditAmount:36e4,actualPrice:42e4},{orderId:"YH202505230919583236",productName:"订单宝-银行精选",createTime:1747967828e3,guidePrice:38e4,modelName:"奥迪A7L 2024款 45 TFSI 豪华型",exterior:"白色",interior:"棕色",vehicleId:"V002",vin:"P0W7HHW583SZPE1W4",status:"processing",preCreditAmount:304e3,actualPrice:35e4},{orderId:"YH202505230915123456",productName:"订单宝-银行精选",createTime:1747967712e3,guidePrice:52e4,modelName:"奔驰E300L 2024款 豪华型",exterior:"银色",interior:"米色",vehicleId:"V003",vin:"WDDWF4JB0FR123456",status:"completed",preCreditAmount:416e3,actualPrice:48e4}],M=[{label:"处理中",value:"processing"},{label:"已完成",value:"completed"}],T=[{label:"待确认",value:"unconfirmed"},{label:"已确认",value:"confirmed"},{label:"已取消",value:"cancelled"}],A=[{label:"未开始",value:"not_started"},{label:"进行中",value:"in_progress"},{label:"已完成",value:"finished"},{label:"已暂停",value:"paused"}],$=async()=>{try{n(!0);const e=await I.validateFields();console.log("Search values:",e)}catch(e){console.error("Search error:",e)}finally{n(!1)}},B=e=>{v(`/orderManage/detail/${e}`)},L=e=>{F(e),j(!0),d.setFieldsValue({orderId:e.orderId,modelName:e.modelName,guidePrice:e.guidePrice,vin:e.vin,preCreditAmount:e.preCreditAmount||Math.floor(e.guidePrice*.8)})},O=e=>{v(`/taskCenter/priceCheckDetail/${e.orderId}`)},V=async()=>{try{const e=await d.validateFields();console.log("Pre-credit values:",e),k.success("预授信处理成功"),j(!1),d.resetFields(),x(a=>a.map(l=>l.orderId===(i==null?void 0:i.orderId)?{...l,preCreditAmount:e.preCreditAmount,status:"processing"}:l))}catch(e){console.error("Form validation failed:",e)}},D=()=>{j(!1),d.resetFields()},E=async()=>{try{const e=await c.validateFields();console.log("Price check values:",e),k.success("核价处理成功"),y(!1),c.resetFields(),x(a=>a.map(l=>l.orderId===(i==null?void 0:i.orderId)?{...l,actualPrice:e.actualPrice,status:"completed"}:l))}catch(e){console.error("Form validation failed:",e)}},R=()=>{y(!1),c.resetFields()},z=()=>{I.resetFields()},H=[{title:"订单号",dataIndex:"orderId",key:"orderId",width:180,render:e=>t.jsx("a",{onClick:()=>B(e),children:e})},{title:"产品名称",dataIndex:"productName",key:"productName",width:150},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180,render:e=>new Date(e).toLocaleString()},{title:"厂商指导价",dataIndex:"guidePrice",key:"guidePrice",width:120,render:e=>`¥${e.toLocaleString()}`},{title:"车型",dataIndex:"modelName",key:"modelName",width:250},{title:"外观",dataIndex:"exterior",key:"exterior",width:100},{title:"内饰",dataIndex:"interior",key:"interior",width:100},{title:"车辆ID",dataIndex:"vehicleId",key:"vehicleId",width:100},{title:"车架号",dataIndex:"vin",key:"vin",width:180},{title:"预授信金额",dataIndex:"preCreditAmount",key:"preCreditAmount",width:120,render:e=>e?`¥${e.toLocaleString()}`:"-"},{title:"实际价格",dataIndex:"actualPrice",key:"actualPrice",width:120,render:e=>e?`¥${e.toLocaleString()}`:"-"},{title:"状态",dataIndex:"status",key:"status",width:100,render:e=>{const a={processing:{color:"processing",text:"进行中"},completed:{color:"success",text:"已完成"}},{color:l,text:W}=a[e];return t.jsx(Q,{color:l,children:W})}},{title:"操作",key:"action",fixed:"right",width:200,render:(e,a)=>t.jsxs(f,{size:"middle",children:[t.jsx(m,{type:"primary",size:"small",onClick:()=>L(a),disabled:a.status==="processing",children:"预授信"}),t.jsx(m,{type:"default",size:"small",onClick:()=>O(a),children:"重新核价"})]})}];return q.useEffect(()=>{n(!0),setTimeout(()=>{x(N),n(!1)},1e3)},[]),t.jsxs("div",{style:{padding:"24px"},children:[t.jsxs(J,{children:[t.jsxs(r,{form:I,layout:"inline",style:{marginBottom:"16px"},children:[t.jsx(r.Item,{name:"orderNumber",label:"订单号",children:t.jsx(s,{placeholder:"请输入订单号",allowClear:!0})}),t.jsx(r.Item,{name:"dealer",label:"经销商",children:t.jsx(s,{placeholder:"请输入经销商",allowClear:!0})}),t.jsx(r.Item,{name:"progressStatus",label:"进度状态",children:t.jsx(p,{mode:"multiple",placeholder:"请选择进度状态",style:{width:200},allowClear:!0,children:M.map(e=>t.jsx(g,{value:e.value,children:e.label},e.value))})}),t.jsx(r.Item,{name:"orderStatus",label:"订单状态",children:t.jsx(p,{mode:"multiple",placeholder:"请选择订单状态",style:{width:200},allowClear:!0,children:T.map(e=>t.jsx(g,{value:e.value,children:e.label},e.value))})}),t.jsx(r.Item,{name:"taskStatus",label:"任务状态",children:t.jsx(p,{mode:"multiple",placeholder:"请选择任务状态",style:{width:200},allowClear:!0,children:A.map(e=>t.jsx(g,{value:e.value,children:e.label},e.value))})}),t.jsx(r.Item,{children:t.jsxs(f,{children:[t.jsx(m,{type:"primary",icon:t.jsx(_,{}),onClick:$,loading:b,children:"查询"}),t.jsx(m,{icon:t.jsx(X,{}),onClick:z,children:"重置"})]})})]}),t.jsx(K,{columns:H,dataSource:C,loading:b,rowKey:"vehicleId",scroll:{x:1800},pagination:{total:C.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条`}})]}),t.jsx(w,{title:"预授信处理",open:P,onOk:V,onCancel:D,width:600,children:t.jsxs(r,{form:d,layout:"inline",children:[t.jsx(u,{span:24,children:t.jsx(r.Item,{name:"orderId",label:"订单号",children:t.jsx(s,{disabled:!0})})}),t.jsx(u,{span:24,children:t.jsx(r.Item,{name:"modelName",label:"车型",children:t.jsx(s,{disabled:!0})})}),t.jsx(u,{span:24,children:t.jsx(r.Item,{name:"vin",label:"车架号",children:t.jsx(s,{disabled:!0})})}),t.jsx(u,{span:24,children:t.jsx(r.Item,{name:"preCreditAmount",label:"预授信金额",rules:[{required:!0,message:"请输入预授信金额"},{type:"number",min:0,message:"预授信金额必须大于0"}],children:t.jsx(h,{style:{width:"100%"},formatter:e=>`¥ ${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),min:0,placeholder:"请输入预授信金额"})})})]})}),t.jsx(w,{title:"核价处理",open:S,onOk:E,onCancel:R,width:600,children:t.jsxs(r,{form:c,layout:"vertical",children:[t.jsx(r.Item,{name:"orderId",label:"订单号",children:t.jsx(s,{disabled:!0})}),t.jsx(r.Item,{name:"modelName",label:"车型",children:t.jsx(s,{disabled:!0})}),t.jsx(r.Item,{name:"guidePrice",label:"厂商指导价",children:t.jsx(h,{style:{width:"100%"},formatter:e=>`¥ ${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>Number(e==null?void 0:e.replace(/\¥\s?|(,*)/g,"")),disabled:!0})}),t.jsx(r.Item,{name:"preCreditAmount",label:"预授信金额",children:t.jsx(h,{style:{width:"100%"},formatter:e=>`¥ ${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>Number(e==null?void 0:e.replace(/\¥\s?|(,*)/g,"")),disabled:!0})}),t.jsx(r.Item,{name:"actualPrice",label:"实际核价",rules:[{required:!0,message:"请输入实际核价"},{type:"number",min:0,message:"实际核价必须大于0"}],children:t.jsx(h,{style:{width:"100%"},formatter:e=>`¥ ${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),min:0,placeholder:"请输入实际核价"})}),t.jsx(r.Item,{name:"remark",label:"备注",children:t.jsx(s.TextArea,{rows:4,placeholder:"请输入备注信息"})})]})})]})};export{se as default};
