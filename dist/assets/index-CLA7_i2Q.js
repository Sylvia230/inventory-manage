import{r as p,F as s,j as e,R as m,a as l,I as x,S as k,B as i,s as o}from"./index-DvfBz0Aq.js";import{G as C,b as T}from"./taskCenter-BeLUxXp9.js";import{S as c}from"./index-d61f7bay.js";import{R as F}from"./SearchOutlined-gVi5Bzmb.js";import{R as N}from"./ReloadOutlined-D5ZHyIf8.js";import{F as R}from"./Table-Br_T8S6M.js";import{T as z}from"./index-eQ8B7oFq.js";import"./Pagination-DitBrzk5.js";const D="_container_g8pzx_1",A={container:D},K=()=>{const[d,u]=p.useState(!1),[n]=s.useForm(),[j,h]=p.useState([]),w=async a=>{try{u(!0);const t=await n.validateFields();let r=await C({page:1,pageSize:20,type:3,...t});console.log("Search values:",t,r),h(r||[])}catch(t){console.error("Search error:",t)}finally{u(!1)}},y=()=>{n.resetFields()},S=a=>{switch(a){case"待推送":return"warning";case"已推送":return"success";default:return"default"}},b=[{title:"客户名称",dataIndex:"vendorName",key:"vendorName",width:120},{title:"订单号",dataIndex:"orderNo",key:"orderNo",width:150},{title:"产品类型",dataIndex:"bizCategorySubDesc",key:"bizCategorySubDesc",width:120},{title:"状态",dataIndex:"taskStatusDesc",key:"taskStatusDesc",width:100,render:a=>e.jsx(z,{color:S(a),children:a})},{title:"资方名称",dataIndex:"capitalName",key:"capitalName",width:120},{title:"合同金额",dataIndex:"contractAmountStr",key:"contractAmountStr",width:120},{title:"操作",key:"action",fixed:"right",width:120,render:(a,t)=>e.jsx("span",{children:e.jsx(i,{type:"link",onClick:()=>g(t),disabled:t.status==="已推送",children:"推送"})})}],g=async a=>{if(a.status==="已推送"){o.warning("该记录已经推送，无需重复推送");return}try{o.loading("正在推送...",0),await T(a.taskId),o.destroy(),o.success("推送成功"),h(t=>t.map(r=>r.id===a.id?{...r,status:"已推送"}:r))}catch(t){console.error("推送失败:",t),o.destroy(),o.error("推送失败，请重试")}},v=[{label:"待审核",value:"待审核"},{label:"审核中",value:"审核中"},{label:"已审核",value:"已审核"},{label:"已驳回",value:"已驳回"}],f=[{label:"待支付",value:"待支付"},{label:"已支付",value:"已支付"},{label:"已取消",value:"已取消"},{label:"已完成",value:"已完成"}],I=[{label:"待推送",value:"待推送"},{label:"已推送",value:"已推送"}];return e.jsxs("div",{className:A.container,children:[e.jsxs(s,{form:n,onFinish:w,layout:"inline",children:[e.jsxs(m,{gutter:24,style:{width:"100%"},children:[e.jsx(l,{span:8,children:e.jsx(s.Item,{name:"orderNo",label:"订单号",children:e.jsx(x,{placeholder:"请输入订单号",allowClear:!0})})}),e.jsx(l,{span:8,children:e.jsx(s.Item,{name:"dealer",label:"经销商",children:e.jsx(x,{placeholder:"请输入经销商",allowClear:!0})})}),e.jsx(l,{span:8,children:e.jsx(s.Item,{name:"progressStatus",label:"进度状态",children:e.jsx(c,{mode:"multiple",placeholder:"请选择进度状态",allowClear:!0,options:v,maxTagCount:"responsive"})})})]}),e.jsxs(m,{gutter:24,style:{width:"100%"},children:[e.jsx(l,{span:8,children:e.jsx(s.Item,{name:"orderStatus",label:"订单状态",children:e.jsx(c,{mode:"multiple",placeholder:"请选择订单状态",allowClear:!0,options:f,maxTagCount:"responsive"})})}),e.jsx(l,{span:8,children:e.jsx(s.Item,{name:"taskStatus",label:"任务状态",children:e.jsx(c,{mode:"multiple",placeholder:"请选择任务状态",allowClear:!0,options:I,maxTagCount:"responsive"})})}),e.jsx(l,{span:8,children:e.jsxs(k,{children:[e.jsx(i,{icon:e.jsx(F,{}),type:"primary",htmlType:"submit",loading:d,children:"查询"}),e.jsx(i,{icon:e.jsx(N,{}),onClick:y,children:"重置"})]})})]})]}),e.jsx(R,{columns:b,dataSource:j,rowKey:"id",loading:d,scroll:{x:1500},pagination:{showSizeChanger:!0,showQuickJumper:!0,showTotal:a=>`共 ${a} 条`}})]})};export{K as default};
