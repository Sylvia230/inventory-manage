import{r as x,b as g,j as e,S as c,C as y,c as w,s as I,T as f}from"./index-DMKvYnLr.js";import{o as k}from"./index-BfsuDWAa.js";import{D as r}from"./index-DFjPstm4.js";import{I as j}from"./index-DrbpgBqH.js";import{F as u}from"./Table-34TOMWnZ.js";import{T as b}from"./index-DGhDchMJ.js";import{o as v,a as R}from"./index-k-yQ8X6B.js";import"./mobx.esm-J_RULll_.js";import"./Pagination-D83B2W2M.js";import"./index-CIhK1E4t.js";var C={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};function m(){return m=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},m.apply(this,arguments)}const E=(t,i)=>x.createElement(g,m({},t,{ref:i,icon:C})),A=x.forwardRef(E),P=({orderSimpleDTO:t})=>e.jsxs(r,{bordered:!0,children:[e.jsx(r.Item,{label:"订单号",span:3,children:t.orderNo}),e.jsx(r.Item,{label:"产品名称",span:3,children:t.bizCategoryDesc}),e.jsx(r.Item,{label:"申请时间",span:3,children:t.createTimeStr}),e.jsx(r.Item,{label:"订单状态",span:3,children:t.orderStatusDesc}),e.jsx(r.Item,{label:"经销商",span:3,children:t.vendorName}),e.jsx(r.Item,{label:"业务经理",span:3,children:t.managerName}),e.jsx(r.Item,{label:"经销商联系方式",span:3,children:t.dealerContact}),e.jsx(r.Item,{label:"经销商经营范围",span:3,children:t.dealerBusinessScope}),(t==null?void 0:t.bizCategory)===2&&e.jsxs(e.Fragment,{children:[e.jsx(r.Item,{label:"供应商",span:3,children:t.supplier}),e.jsx(r.Item,{label:"联系人",span:3,children:t.supplierContact}),e.jsx(r.Item,{label:"供应商联系方式",span:3,children:t.supplierContactInfo})]}),e.jsx(r.Item,{label:"出款凭证",span:3,children:e.jsx(c,{})})]}),S=({vehicle:t})=>{var i,n,l;return e.jsx("div",{style:{padding:"16px"},children:e.jsxs(c,{direction:"vertical",size:"large",style:{width:"100%"},children:[t.inspectionPhotos&&t.inspectionPhotos.length>0&&e.jsx(r,{title:"验车照片",bordered:!0,children:e.jsx(r.Item,{span:3,children:e.jsx(c,{wrap:!0,children:(i=t.inspectionPhotos)==null?void 0:i.map((d,o)=>e.jsx(j,{width:200,height:150,src:d,alt:`验车照片${o+1}`,style:{objectFit:"cover"}},o))})})}),t.damagePhotos&&t.damagePhotos.length>0&&e.jsx(r,{title:"质损照片",bordered:!0,children:e.jsx(r.Item,{span:3,children:e.jsx(c,{wrap:!0,children:(n=t.damagePhotos)==null?void 0:n.map((d,o)=>e.jsx(j,{width:200,height:150,src:d,alt:`质损照片${o+1}`,style:{objectFit:"cover"}},o))})})}),t.documents&&t.documents.length>0&&e.jsx(r,{title:"资料信息",bordered:!0,children:(l=t.documents)==null?void 0:l.map((d,o)=>e.jsx(r.Item,{label:d.name,span:3,children:e.jsx("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",children:"查看文件"})},o))})]})})},N=({orderDetail:t})=>{var o;const[i,n]=x.useState([]);console.log("...orderDetail",t);const l=[{title:"车辆ID",dataIndex:"id",key:"id",width:80,render:(s,a)=>a.isExpandRow?{children:e.jsxs(c,{children:[e.jsx(A,{rotate:i.includes(a.id)?90:0}),"验车照片/质损照片/资料信息"]}),props:{colSpan:l.length}}:s},{title:"车架号",dataIndex:"vin",key:"vin",width:180,render:(s,a)=>a.isExpandRow?{props:{colSpan:0}}:a.vin},{title:"车型",dataIndex:"vehicleName",key:"vehicleName",width:200,render:(s,a)=>a.isExpandRow?{props:{colSpan:0}}:a.model},{title:"外观/内饰",dataIndex:"outerColorDesc",key:"outerColorDesc",width:150,render:(s,a)=>a.isExpandRow?{props:{colSpan:0}}:e.jsxs(c,{direction:"vertical",size:"small",children:[e.jsxs("span",{children:["外观：",a.outerColorDesc]}),e.jsxs("span",{children:["内饰：",a.innerColorDesc]})]})},{title:"厂商指导价",dataIndex:"guidePrice",key:"guidePrice",width:120,render:(s,a)=>a.isExpandRow?{props:{colSpan:0}}:`${a.guidePrice}`},{title:"核价金额",dataIndex:"appraisedPrice",key:"appraisedPrice",width:120,render:(s,a)=>a.isExpandRow?{props:{colSpan:0}}:`${a.appraisedPrice}`},{title:"保证金",dataIndex:"contractAmount",key:"contractAmount",width:120,render:(s,a)=>a.isExpandRow?{props:{colSpan:0}}:`${a.contractAmount}`},{title:"保证金比例",dataIndex:"depositRate",key:"depositRate",width:120,render:(s,a)=>a.isExpandRow?{props:{colSpan:0}}:`${a.depositRate}%`},{title:"合同单价/定金",key:"contract",width:150,render:(s,a)=>{if(a.isExpandRow)return{props:{colSpan:0}};const p=a;return e.jsxs(c,{direction:"vertical",size:"small",children:[e.jsxs("span",{children:["单价：",p.contractPrice]}),e.jsxs("span",{children:["定金：",p.downPayment]})]})}}],d=s=>{var p;if(!s.isExpandRow)return null;const a=(p=t.orderCarList)==null?void 0:p.find(h=>h.id===s.vehicleId);return a?e.jsx(S,{vehicle:a}):null};return e.jsx(c,{direction:"vertical",size:"large",style:{width:"100%"},children:(o=t==null?void 0:t.orderCarList)==null?void 0:o.map((s,a)=>e.jsx(y,{title:`车辆 ${a+1}`,style:{marginBottom:16},children:e.jsx(u,{columns:l,dataSource:[s,{id:`${s.id}-expand`,isExpandRow:!0,vehicleId:s.id}],rowKey:"id",pagination:!1,scroll:{x:"max-content"},expandable:{expandedRowRender:d,rowExpandable:p=>p.isExpandRow===!0,expandedRowKeys:i,onExpand:(p,h)=>{n(p?[h.id]:[])}}})},s.id))})},$=({orderDetail:t})=>{const i=[{title:"车型",dataIndex:"model",key:"model",width:150},{title:"车架号",dataIndex:"vin",key:"vin",width:180},{title:"仓库",dataIndex:"warehouseName",key:"warehouseName",width:150},{title:"联系人/电话",key:"contact",width:180,render:(n,l)=>e.jsxs(c,{direction:"vertical",size:"small",children:[e.jsxs("span",{children:["联系人：",l.contactPerson]}),e.jsxs("span",{children:["电话：",l.contactPhone]})]})},{title:"仓库地址",dataIndex:"warehouseAddress",key:"warehouseAddress",width:200},{title:"出库时间",dataIndex:"outboundTime",key:"outboundTime",width:180},{title:"入库时间",dataIndex:"inboundTime",key:"inboundTime",width:180}];return e.jsx(u,{columns:i,dataSource:t.storageInfo||[],rowKey:"vin",pagination:!1,scroll:{x:"max-content"}})},z=({orderDetail:t})=>{const i=[{title:"车型",dataIndex:"model",key:"model",width:150},{title:"车架号",dataIndex:"vin",key:"vin",width:180},{title:"物流公司",dataIndex:"logisticsCompany",key:"logisticsCompany",width:150},{title:"运单号",dataIndex:"trackingNumber",key:"trackingNumber",width:180},{title:"发货时间",dataIndex:"deliveryTime",key:"deliveryTime",width:180},{title:"预计送达时间",dataIndex:"estimatedDeliveryTime",key:"estimatedDeliveryTime",width:180},{title:"物流状态",dataIndex:"logisticsStatus",key:"logisticsStatus",width:120,render:n=>e.jsx(b,{color:n==="in_transit"?"blue":n==="delivered"?"green":n==="exception"?"red":"default",children:n==="in_transit"?"运输中":n==="delivered"?"已送达":n==="exception"?"异常":n})}];return e.jsx(u,{columns:i,dataSource:t.logisticsInfo||[],rowKey:"vin",pagination:!1,scroll:{x:"max-content"}})},F=({orderDetail:t})=>{const i=[{title:"结算单号",dataIndex:"settlementNumber",key:"settlementNumber",width:180},{title:"结算金额",dataIndex:"settlementAmount",key:"settlementAmount",width:150,render:n=>`¥${n.toLocaleString()}`},{title:"结算状态",dataIndex:"settlementStatus",key:"settlementStatus",width:120,render:n=>e.jsx(b,{color:n==="pending"?"orange":n==="completed"?"green":n==="failed"?"red":"default",children:n==="pending"?"待结算":n==="completed"?"已结算":n==="failed"?"结算失败":n})},{title:"结算时间",dataIndex:"settlementTime",key:"settlementTime",width:180}];return e.jsx(u,{columns:i,dataSource:t.settlementInfo||[],rowKey:"settlementNumber",pagination:!1,scroll:{x:"max-content"}})},_=({orderDetail:t})=>{const i=[{key:"disbursementAccount",label:"出款账户"},{key:"supplierCollectionAccount",label:"供应商收款账户"},{key:"dealerRepaymentAccount",label:"经销商还款账户"},{key:"capitalCollectionAccount",label:"资方收款账户"},{key:"marginCollectionAccount",label:"保证金收款账户"},{key:"serviceFeeCollectionAccount",label:"服务费收款账户"},{key:"storageFeeCollectionAccount",label:"仓储费收款账户"},{key:"logisticsFeeCollectionAccount",label:"物流费收款账户"}];return e.jsx(c,{direction:"vertical",size:"large",style:{width:"100%"},children:i.map(n=>{const l=t[n.key];return l?e.jsxs(r,{title:n.label,bordered:!0,style:{marginBottom:24},children:[e.jsx(r.Item,{label:"户名",span:3,children:l.accountName}),e.jsx(r.Item,{label:"账号",span:3,children:l.bankAccount}),e.jsx(r.Item,{label:"开户行",span:3,children:l.openingBank})]},n.key):null})})},Q=k(()=>{const{id:t}=w();console.log("订单详情页面，获取到的订单号:",t);const[i,n]=x.useState(null);x.useEffect(()=>()=>{v.clear()},[]),x.useEffect(()=>{t&&l(t)},[t]);const l=async o=>{try{const s=await R(o);n(s)}catch{I.error("加载详情失败")}};if(!i)return e.jsx("div",{children:"加载中..."});const d=[{key:"basic",label:"基本信息",children:e.jsx(P,{orderSimpleDTO:i.orderSimpleDTO})},{key:"vehicle",label:"车辆信息",children:e.jsx(N,{orderDetail:i})},{key:"storage",label:"仓储信息",children:e.jsx($,{orderDetail:i})},{key:"logistics",label:"物流信息",children:e.jsx(z,{orderDetail:i})},{key:"settlement",label:"结算信息",children:e.jsx(F,{orderDetail:i})},{key:"account",label:"账户信息",children:e.jsx(_,{orderDetail:i})}];return e.jsx("div",{children:e.jsx(y,{style:{marginTop:"24px"},children:e.jsx(f,{items:d})})})});export{Q as default};
