import{F as r,r as s,j as e,R,a as i,I as m,S as x,B as d,e as N}from"./index-DMKvYnLr.js";import{G as C}from"./contract-R5gQMaLR.js";import{R as F}from"./SearchOutlined-DDdjSPdr.js";import{R as T}from"./ReloadOutlined-Ch4B7x8x.js";import{F as z}from"./Table-34TOMWnZ.js";import{T as D}from"./index-DGhDchMJ.js";import{R as L}from"./EyeOutlined-C5Km8UI_.js";import"./Pagination-D83B2W2M.js";import"./index-CIhK1E4t.js";const _="_container_1iukc_1",g={container:_},Q=()=>{const[l]=r.useForm(),[j,p]=s.useState(!1),[y,f]=s.useState([]),[n,u]=s.useState({current:1,pageSize:10,total:0});s.useEffect(()=>{h()},[n.current,n.pageSize]);const v=[{label:"待签署",value:"pending",color:"orange"},{label:"已签署",value:"signed",color:"green"},{label:"已作废",value:"void",color:"red"},{label:"已过期",value:"expired",color:"gray"}],w=[{label:"购车合同",value:"purchase"},{label:"租赁合同",value:"lease"},{label:"服务合同",value:"service"},{label:"其他",value:"other"}],b=[{title:"订单号",dataIndex:"orderNo",key:"orderNo",width:180},{title:"客户名称",dataIndex:"vendorName",key:"vendorName",width:150},{title:"合同名称",dataIndex:"contractName",key:"contractName",width:200},{title:"合同状态",dataIndex:"signStatusDesc",key:"signStatusDesc",width:100,render:t=>{const a=v.find(o=>o.value===t);return a?e.jsx(D,{color:a.color,children:a.label}):t}},{title:"合同类型",dataIndex:"contractTypeDesc",key:"contractTypeDesc",width:120,render:t=>{const a=w.find(o=>o.value===t);return a?a.label:t}},{title:"操作",key:"action",fixed:"right",width:100,render:(t,a)=>e.jsx(x,{size:"middle",children:e.jsx(d,{type:"link",icon:e.jsx(L,{}),onClick:()=>S(a),children:"查看"})})}],S=async t=>{console.log("查看合同:",t);try{const a=localStorage.getItem("token"),o=await N.get("/gdv"+t.path,{responseType:"blob",headers:{Authorization:`Bearer ${a}`}}),c=URL.createObjectURL(o.data);window.open(c)}catch(a){console.error("加载图片失败",a)}},h=async()=>{p(!0);try{const t=await l.validateFields(),a={...t,pageNo:n.current,pageSize:n.pageSize};console.log("搜索条件:",t);const o=await C(a);f(o==null?void 0:o.result),u(c=>({...c,total:(o==null?void 0:o.totalCount)||0}))}catch(t){console.error("查询数据失败:",t)}finally{p(!1)}},k=t=>{u(t)},I=()=>{l.resetFields()};return e.jsxs("div",{className:g.container,children:[e.jsx(r,{form:l,layout:"inline",className:g.searchForm,children:e.jsxs(R,{gutter:24,style:{width:"100%"},children:[e.jsx(i,{span:8,children:e.jsx(r.Item,{name:"orderNo",label:"订单号",children:e.jsx(m,{placeholder:"请输入订单号"})})}),e.jsx(i,{span:8,children:e.jsx(r.Item,{name:"vendorName",label:"客户名称",children:e.jsx(m,{placeholder:"请输入客户名称"})})}),e.jsx(i,{span:8,children:e.jsx(r.Item,{children:e.jsxs(x,{children:[e.jsx(d,{type:"primary",icon:e.jsx(F,{}),onClick:h,children:"搜索"}),e.jsx(d,{icon:e.jsx(T,{}),onClick:I,children:"重置"})]})})})]})}),e.jsx(z,{columns:b,dataSource:y,loading:j,pagination:{...n,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共 ${t} 条`},onChange:k,scroll:{x:1100}})]})};export{Q as default};
