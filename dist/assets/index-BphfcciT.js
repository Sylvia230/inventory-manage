import{F as a,r as t,s as p,j as e,R as k,a as i,I as n,S as B,B as c,M as v}from"./index-DFmaZUvW.js";import{g as K}from"./finance-DrgMn3yX.js";import{d as Q}from"./dayjs.min-Bn1RboG_.js";import{S as N}from"./index-Bqyftg-u.js";import{D as W}from"./index-Dp7Sql1h.js";import{R as X}from"./SearchOutlined-DL9voMCh.js";import{R as U}from"./ReloadOutlined-CzbpDPLD.js";import{R as Z}from"./PlusOutlined-BJcRHrv7.js";import{F as ee}from"./Table-DIemrw74.js";import{C as le}from"./index-B2MT_ML1.js";import"./Pagination-B-JRzDfY.js";const ae="_container_e2zo2_1",te={container:ae},{RangePicker:se}=W,je=()=>{const[y]=a.useForm(),[s]=a.useForm(),[S,w]=t.useState(!1),[T,d]=t.useState(!1),[g,u]=t.useState(!1),[re,h]=t.useState(null),[R,x]=t.useState(!1),[b,j]=t.useState(null),[C,f]=t.useState(1),[I,D]=t.useState(10),[A,F]=t.useState(0),M=[{label:"身份证",value:"ID_CARD"},{label:"护照",value:"PASSPORT"},{label:"军官证",value:"MILITARY_ID"},{label:"港澳通行证",value:"HONG_KONG_MACAO"},{label:"台湾通行证",value:"TAIWAN"}],_=[{value:"ICBC",label:"中国工商银行",children:[{value:"ICBC_SH_001",label:"上海分行"},{value:"ICBC_SH_002",label:"浦东支行"},{value:"ICBC_SH_003",label:"徐汇支行"}]},{value:"ABC",label:"中国农业银行",children:[{value:"ABC_SH_001",label:"上海分行"},{value:"ABC_SH_002",label:"浦东支行"},{value:"ABC_SH_003",label:"徐汇支行"}]},{value:"BOC",label:"中国银行",children:[{value:"BOC_SH_001",label:"上海分行"},{value:"BOC_SH_002",label:"浦东支行"},{value:"BOC_SH_003",label:"徐汇支行"}]}],H=[{title:"银行账户户名",dataIndex:"accountName",width:150},{title:"卡号",dataIndex:"bankAccount",width:180},{title:"开户行",dataIndex:"bankBranchName",width:150},{title:"商户id",dataIndex:"merchantId",width:150},{title:"绑定手机号",dataIndex:"phone",width:150},{title:"证件号",dataIndex:"idNumber",width:180},{title:"归属方",dataIndex:"owner",width:120},{title:"创建时间",dataIndex:"createTime",width:180,render:l=>l?Q(l).format("YYYY-MM-DD HH:mm:ss"):""},{title:"操作",key:"action",fixed:"right",width:180,render:(l,r)=>e.jsxs(B,{size:"middle",children:[e.jsx(c,{type:"link",onClick:()=>q(r),children:"编辑"}),e.jsx(c,{type:"link",danger:!0,onClick:()=>L(r),children:"删除"})]})}],[O,$]=t.useState([]);t.useEffect(()=>{o()},[C,I]);const o=async l=>{w(!0);try{const r={page:C,pageSize:I,...l},m=await K(r);console.log("银行卡列表",m),m.result&&($(m.result),F(m.totalCount||0))}catch(r){console.error("获取银行卡列表失败:",r),p.error("获取数据失败")}finally{w(!1)}},P=l=>{console.log("搜索条件:",l),f(1),o(l)},z=()=>{y.resetFields(),f(1),o()},E=()=>{u(!1),h(null),d(!0),s.resetFields()},q=l=>{u(!0),h(l),d(!0),s.setFieldsValue({accountName:l.accountName,bankBranch:l.bankBranch,cardNumber:l.cardNumber,phone:l.phone,idType:l.idType,idNumber:l.idNumber})},V=()=>{d(!1),u(!1),h(null),s.resetFields()},Y=async()=>{try{const l=await s.validateFields();console.log("保存银行卡:",l),p.success(g?"编辑成功":"新增成功"),d(!1),u(!1),h(null),s.resetFields(),o()}catch(l){console.error("表单验证失败:",l)}},L=l=>{j(l),x(!0)},G=async()=>{try{console.log("删除银行卡:",b),p.success("删除成功"),x(!1),j(null),o()}catch(l){console.error("删除失败:",l),p.error("删除失败")}},J=()=>{x(!1),j(null)};return e.jsxs("div",{className:te.container,children:[e.jsxs(a,{form:y,onFinish:P,layout:"inline",children:[e.jsxs(k,{gutter:24,style:{width:"100%"},children:[e.jsx(i,{span:8,children:e.jsx(a.Item,{name:"cardNumber",label:"银行卡账号",children:e.jsx(n,{placeholder:"请输入银行卡账号",allowClear:!0})})}),e.jsx(i,{span:8,children:e.jsx(a.Item,{name:"accountName",label:"户名",children:e.jsx(n,{placeholder:"请输入户名",allowClear:!0})})}),e.jsx(i,{span:8,children:e.jsx(a.Item,{name:"bankName",label:"银行",children:e.jsx(N,{placeholder:"请选择银行",options:_,allowClear:!0})})})]}),e.jsx(i,{span:8,children:e.jsx(a.Item,{name:"createTime",label:"创建时间",children:e.jsx(se,{style:{width:"100%"}})})}),e.jsx(k,{gutter:24,style:{width:"100%"},children:e.jsx(i,{span:6,children:e.jsxs(B,{children:[e.jsx(c,{icon:e.jsx(X,{}),type:"primary",htmlType:"submit",loading:S,children:"查询"}),e.jsx(c,{icon:e.jsx(U,{}),onClick:z,children:"重置"}),e.jsx(c,{type:"primary",icon:e.jsx(Z,{}),onClick:E,children:"新增银行卡"})]})})})]}),e.jsx(ee,{columns:H,dataSource:O,loading:S,pagination:{current:C,pageSize:I,total:A,showSizeChanger:!0,showQuickJumper:!0,showTotal:l=>`共 ${l} 条`},onChange:l=>{f(l.current||1),D(l.pageSize||10)},scroll:{x:1300}}),e.jsx(v,{title:g?"编辑银行卡":"新增银行卡",open:T,onOk:Y,onCancel:V,width:600,children:e.jsxs(a,{form:s,layout:"inline",requiredMark:!1,children:[e.jsx(a.Item,{name:"accountName",label:"户名",rules:[{required:!0,message:"请输入户名"}],style:{width:"100%"},children:e.jsx(n,{placeholder:"请输入户名"})}),e.jsx(a.Item,{name:"bankBranch",label:"开户支行",rules:[{required:!0,message:"请选择开户支行"}],style:{width:"100%"},children:e.jsx(le,{options:_,placeholder:"请选择开户支行",expandTrigger:"hover"})}),e.jsx(a.Item,{name:"cardNumber",label:"账户",rules:[{required:!0,message:"请输入账户"},{pattern:/^\d{16,19}$/,message:"请输入16-19位数字"}],style:{width:"100%"},children:e.jsx(n,{placeholder:"请输入账户"})}),e.jsx(a.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],style:{width:"100%"},children:e.jsx(n,{placeholder:"请输入手机号"})}),e.jsx(a.Item,{name:"idType",label:"证件类型",style:{width:"100%"},children:e.jsx(N,{placeholder:"请选择证件类型",options:M,allowClear:!0})}),e.jsx(a.Item,{name:"idNumber",label:"证件编号",rules:[{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"请输入正确的证件编号"}],style:{width:"100%"},children:e.jsx(n,{placeholder:"请输入证件编号"})})]})}),e.jsxs(v,{title:"删除确认",open:R,onOk:G,onCancel:J,okText:"确认",cancelText:"取消",okButtonProps:{danger:!0},children:[e.jsx("p",{children:"确定要删除该银行卡吗？"}),b&&e.jsxs("p",{style:{color:"#666",fontSize:"14px"},children:["卡号：",b.cardNumber.replace(/(\d{4})\d+(\d{4})/,"$1****$2")]})]})]})};export{je as default};
